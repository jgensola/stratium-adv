!function(d,c){"object"==typeof exports&&"object"==typeof module?module.exports=c():"function"==typeof define&&define.amd?define("scrollMonitor",[],c):"object"==typeof exports?exports.scrollMonitor=c():d.scrollMonitor=c()}(this,function(){return function(d){function f(a){if(e[a]){return e[a].exports}var b=e[a]={exports:{},id:a,loaded:!1};return d[a].call(b.exports,b,b.exports,f),b.loaded=!0,b.exports}var e={};return f.m=d,f.c=e,f.p="",f(0)}([function(e,l,i){var k=i(1),n=k.isInBrowser,j=i(2),m=new j(n?document.body:null);m.setStateFromDOM(null),m.listenToDOM(),n&&(window.scrollMonitor=m),e.exports=m},function(d,c){c.VISIBILITYCHANGE="visibilityChange",c.ENTERVIEWPORT="enterViewport",c.FULLYENTERVIEWPORT="fullyEnterViewport",c.EXITVIEWPORT="exitViewport",c.PARTIALLYEXITVIEWPORT="partiallyExitViewport",c.LOCATIONCHANGE="locationChange",c.STATECHANGE="stateChange",c.eventTypes=[c.VISIBILITYCHANGE,c.ENTERVIEWPORT,c.FULLYENTERVIEWPORT,c.EXITVIEWPORT,c.PARTIALLYEXITVIEWPORT,c.LOCATIONCHANGE,c.STATECHANGE],c.isOnServer="undefined"==typeof window,c.isInBrowser=!c.isOnServer,c.defaultOffsets={top:0,bottom:0}},function(p,a,e){function l(b,d){if(!(b instanceof d)){throw new TypeError("Cannot call a class as a function")}}function o(b){return w?0:b===document.body?window.innerHeight||document.documentElement.clientHeight:b.clientHeight}function i(b){return w?0:b===document.body?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight):b.scrollHeight}function r(b){return w?0:b===document.body?window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop}var c=e(1),w=c.isOnServer,t=c.isInBrowser,h=c.eventTypes,n=e(3),s=function(){function b(d,k){function j(){if(q.viewportTop=r(d),q.viewportBottom=q.viewportTop+q.viewportHeight,q.documentHeight=i(d),q.documentHeight!==g){for(f=q.watchers.length;f--;){q.watchers[f].recalculateLocation()}g=q.documentHeight}}function u(){for(m=q.watchers.length;m--;){q.watchers[m].update()}for(m=q.watchers.length;m--;){q.watchers[m].triggerCallbacks()}}l(this,b);var q=this;this.item=d,this.watchers=[],this.viewportTop=null,this.viewportBottom=null,this.documentHeight=i(d),this.viewportHeight=o(d),this.DOMListener=function(){b.prototype.DOMListener.apply(q,arguments)},this.eventTypes=h,k&&(this.containerWatcher=k.create(d));var g,f,m;this.update=function(){j(),u()},this.recalculateLocations=function(){this.documentHeight=0,this.update()}}return b.prototype.listenToDOM=function(){t&&(window.addEventListener?(this.item===document.body?window.addEventListener("scroll",this.DOMListener):this.item.addEventListener("scroll",this.DOMListener),window.addEventListener("resize",this.DOMListener)):(this.item===document.body?window.attachEvent("onscroll",this.DOMListener):this.item.attachEvent("onscroll",this.DOMListener),window.attachEvent("onresize",this.DOMListener)),this.destroy=function(){window.addEventListener?(this.item===document.body?(window.removeEventListener("scroll",this.DOMListener),this.containerWatcher.destroy()):this.item.removeEventListener("scroll",this.DOMListener),window.removeEventListener("resize",this.DOMListener)):(this.item===document.body?(window.detachEvent("onscroll",this.DOMListener),this.containerWatcher.destroy()):this.item.detachEvent("onscroll",this.DOMListener),window.detachEvent("onresize",this.DOMListener))})},b.prototype.destroy=function(){},b.prototype.DOMListener=function(d){this.setStateFromDOM(d)},b.prototype.setStateFromDOM=function(f){var d=r(this.item),j=o(this.item),g=i(this.item);this.setState(d,j,g,f)},b.prototype.setState=function(g,k,m,j){var f=k!==this.viewportHeight||m!==this.contentHeight;if(this.latestEvent=j,this.viewportTop=g,this.viewportHeight=k,this.viewportBottom=g+k,this.contentHeight=m,f){for(var d=this.watchers.length;d--;){this.watchers[d].recalculateLocation()}}this.updateAndTriggerWatchers(j)},b.prototype.updateAndTriggerWatchers=function(f){for(var d=this.watchers.length;d--;){this.watchers[d].update()}for(d=this.watchers.length;d--;){this.watchers[d].triggerCallbacks(f)}},b.prototype.createCustomContainer=function(){return new b},b.prototype.createContainer=function(d){"string"==typeof d?d=document.querySelector(d):d&&d.length>0&&(d=d[0]);var f=new b(d,this);return f.setStateFromDOM(),f.listenToDOM(),f},b.prototype.create=function(f,d){"string"==typeof f?f=document.querySelector(f):f&&f.length>0&&(f=f[0]);var g=new n(this,f,d);return this.watchers.push(g),g},b.prototype.beget=function(f,d){return this.create(f,d)},b}();p.exports=s},function(t,i,n){function a(A,g,k){function C(G,F){if(0!==G.length){for(y=G.length;y--;){q=G[y],q.callback.call(x,F,x),q.isOne&&G.splice(y,1)}}}var x=this;this.watchItem=g,this.container=A,k?k===+k?this.offsets={top:k,bottom:k}:this.offsets={top:k.top||u.top,bottom:k.bottom||u.bottom}:this.offsets=u,this.callbacks={};for(var b=0,j=w.length;b<j;b++){x.callbacks[w[b]]=[]}this.locked=!1;var z,B,E,D,y,q;this.triggerCallbacks=function(F){switch(this.isInViewport&&!z&&C(this.callbacks[f],F),this.isFullyInViewport&&!B&&C(this.callbacks[m],F),this.isAboveViewport!==E&&this.isBelowViewport!==D&&(C(this.callbacks[s],F),B||this.isFullyInViewport||(C(this.callbacks[m],F),C(this.callbacks[c],F)),z||this.isInViewport||(C(this.callbacks[f],F),C(this.callbacks[e],F))),!this.isFullyInViewport&&B&&C(this.callbacks[c],F),!this.isInViewport&&z&&C(this.callbacks[e],F),this.isInViewport!==z&&C(this.callbacks[s],F),!0){case z!==this.isInViewport:case B!==this.isFullyInViewport:case E!==this.isAboveViewport:case D!==this.isBelowViewport:C(this.callbacks[d],F)}z=this.isInViewport,B=this.isFullyInViewport,E=this.isAboveViewport,D=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var H=this.top,G=this.bottom;if(this.watchItem.nodeName){var K=this.watchItem.style.display;"none"===K&&(this.watchItem.style.display="");for(var F=0,I=this.container;I.containerWatcher;){F+=I.containerWatcher.top-I.containerWatcher.container.viewportTop,I=I.containerWatcher.container}var J=this.watchItem.getBoundingClientRect();this.top=J.top+this.container.viewportTop-F,this.bottom=J.bottom+this.container.viewportTop-F,"none"===K&&(this.watchItem.style.display=K)}else{this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=this.container.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom)}this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===H&&void 0===G||this.top===H&&this.bottom===G||C(this.callbacks[o],null)}},this.recalculateLocation(),this.update(),z=this.isInViewport,B=this.isFullyInViewport,E=this.isAboveViewport,D=this.isBelowViewport}var r=n(1),s=r.VISIBILITYCHANGE,f=r.ENTERVIEWPORT,m=r.FULLYENTERVIEWPORT,e=r.EXITVIEWPORT,c=r.PARTIALLYEXITVIEWPORT,o=r.LOCATIONCHANGE,d=r.STATECHANGE,w=r.eventTypes,u=r.defaultOffsets;a.prototype={on:function(j,g,b){switch(!0){case j===s&&!this.isInViewport&&this.isAboveViewport:case j===f&&this.isInViewport:case j===m&&this.isFullyInViewport:case j===e&&this.isAboveViewport&&!this.isInViewport:case j===c&&this.isInViewport&&this.isAboveViewport:if(g.call(this,this.container.latestEvent,this),b){return}}if(!this.callbacks[j]){throw new Error("Tried to add a scroll monitor listener of type "+j+". Your options are: "+w.join(", "))}this.callbacks[j].push({callback:g,isOne:b||!1})},off:function(k,j){if(!this.callbacks[k]){throw new Error("Tried to remove a scroll monitor listener of type "+k+". Your options are: "+w.join(", "))}for(var b,g=0;b=this.callbacks[k][g];g++){if(b.callback===j){this.callbacks[k].splice(g,1);break}}},one:function(b,g){this.on(b,g,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<this.container.viewportTop,this.isBelowViewport=this.bottom>this.container.viewportBottom,this.isInViewport=this.top<this.container.viewportBottom&&this.bottom>this.container.viewportTop,this.isFullyInViewport=this.top>=this.container.viewportTop&&this.bottom<=this.container.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var k=this.container.watchers.indexOf(this),j=this;this.container.watchers.splice(k,1);for(var b=0,g=w.length;b<g;b++){j.callbacks[w[b]].length=0}},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var h=function(b){return function(g,j){this.on.call(this,b,g,j)}},l=0,p=w.length;l<p;l++){var v=w[l];a.prototype[v]=h(v)}t.exports=a}])});