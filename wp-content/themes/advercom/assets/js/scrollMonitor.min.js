!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("scrollMonitor",[],b):"object"==typeof exports?exports.scrollMonitor=b():a.scrollMonitor=b()}(this,function(){return function(b){function c(e){if(a[e]){return a[e].exports}var d=a[e]={exports:{},id:e,loaded:!1};return b[e].call(d.exports,d,d.exports,c),d.loaded=!0,d.exports}var a={};return c.m=b,c.c=a,c.p="",c(0)}([function(b,f,a){var g=a(1),c=g.isInBrowser,h=a(2),d=new h(c?document.body:null);d.setStateFromDOM(null),d.listenToDOM(),c&&(window.scrollMonitor=d),b.exports=d},function(a,b){b.VISIBILITYCHANGE="visibilityChange",b.ENTERVIEWPORT="enterViewport",b.FULLYENTERVIEWPORT="fullyEnterViewport",b.EXITVIEWPORT="exitViewport",b.PARTIALLYEXITVIEWPORT="partiallyExitViewport",b.LOCATIONCHANGE="locationChange",b.STATECHANGE="stateChange",b.eventTypes=[b.VISIBILITYCHANGE,b.ENTERVIEWPORT,b.FULLYENTERVIEWPORT,b.EXITVIEWPORT,b.PARTIALLYEXITVIEWPORT,b.LOCATIONCHANGE,b.STATECHANGE],b.isOnServer="undefined"==typeof window,b.isInBrowser=!b.isOnServer,b.defaultOffsets={top:0,bottom:0}},function(y,q,k){function f(a,c){if(!(a instanceof c)){throw new TypeError("Cannot call a class as a function")}}function z(a){return u?0:a===document.body?window.innerHeight||document.documentElement.clientHeight:a.clientHeight}function g(a){return u?0:a===document.body?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight):a.scrollHeight}function b(a){return u?0:a===document.body?window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop:a.scrollTop}var m=k(1),u=m.isOnServer,v=m.isInBrowser,j=m.eventTypes,d=k(3),x=function(){function a(A,r){function s(){if(n.viewportTop=b(A),n.viewportBottom=n.viewportTop+n.viewportHeight,n.documentHeight=g(A),n.documentHeight!==t){for(l=n.watchers.length;l--;){n.watchers[l].recalculateLocation()}t=n.documentHeight}}function B(){for(o=n.watchers.length;o--;){n.watchers[o].update()}for(o=n.watchers.length;o--;){n.watchers[o].triggerCallbacks()}}f(this,a);var n=this;this.item=A,this.watchers=[],this.viewportTop=null,this.viewportBottom=null,this.documentHeight=g(A),this.viewportHeight=z(A),this.DOMListener=function(){a.prototype.DOMListener.apply(n,arguments)},this.eventTypes=j,r&&(this.containerWatcher=r.create(A));var t,l,o;this.update=function(){s(),B()},this.recalculateLocations=function(){this.documentHeight=0,this.update()}}return a.prototype.listenToDOM=function(){v&&(window.addEventListener?(this.item===document.body?window.addEventListener("scroll",this.DOMListener):this.item.addEventListener("scroll",this.DOMListener),window.addEventListener("resize",this.DOMListener)):(this.item===document.body?window.attachEvent("onscroll",this.DOMListener):this.item.attachEvent("onscroll",this.DOMListener),window.attachEvent("onresize",this.DOMListener)),this.destroy=function(){window.addEventListener?(this.item===document.body?(window.removeEventListener("scroll",this.DOMListener),this.containerWatcher.destroy()):this.item.removeEventListener("scroll",this.DOMListener),window.removeEventListener("resize",this.DOMListener)):(this.item===document.body?(window.detachEvent("onscroll",this.DOMListener),this.containerWatcher.destroy()):this.item.detachEvent("onscroll",this.DOMListener),window.detachEvent("onresize",this.DOMListener))})},a.prototype.destroy=function(){},a.prototype.DOMListener=function(c){this.setStateFromDOM(c)},a.prototype.setStateFromDOM=function(h){var l=b(this.item),c=z(this.item),n=g(this.item);this.setState(l,c,n,h)},a.prototype.setState=function(h,p,c,r){var l=p!==this.viewportHeight||c!==this.contentHeight;if(this.latestEvent=r,this.viewportTop=h,this.viewportHeight=p,this.viewportBottom=h+p,this.contentHeight=c,l){for(var w=this.watchers.length;w--;){this.watchers[w].recalculateLocation()}}this.updateAndTriggerWatchers(r)},a.prototype.updateAndTriggerWatchers=function(c){for(var h=this.watchers.length;h--;){this.watchers[h].update()}for(h=this.watchers.length;h--;){this.watchers[h].triggerCallbacks(c)}},a.prototype.createCustomContainer=function(){return new a},a.prototype.createContainer=function(h){"string"==typeof h?h=document.querySelector(h):h&&h.length>0&&(h=h[0]);var c=new a(h,this);return c.setStateFromDOM(),c.listenToDOM(),c},a.prototype.create=function(h,l){"string"==typeof h?h=document.querySelector(h):h&&h.length>0&&(h=h[0]);var c=new d(this,h,l);return this.watchers.push(c),c},a.prototype.beget=function(c,h){return this.create(c,h)},a}();y.exports=x},function(k,G,D){function z(L,p,l){function a(d,f){if(0!==d.length){for(M=d.length;M--;){h=d[M],h.callback.call(N,f,N),h.isOne&&d.splice(M,1)}}}var N=this;this.watchItem=p,this.container=L,l?l===+l?this.offsets={top:l,bottom:l}:this.offsets={top:l.top||j.top,bottom:l.bottom||j.bottom}:this.offsets=j,this.callbacks={};for(var r=0,n=b.length;r<n;r++){N.callbacks[b[r]]=[]}this.locked=!1;var c,K,u,w,M,h;this.triggerCallbacks=function(d){switch(this.isInViewport&&!c&&a(this.callbacks[x],d),this.isFullyInViewport&&!K&&a(this.callbacks[E],d),this.isAboveViewport!==u&&this.isBelowViewport!==w&&(a(this.callbacks[A],d),K||this.isFullyInViewport||(a(this.callbacks[E],d),a(this.callbacks[J],d)),c||this.isInViewport||(a(this.callbacks[x],d),a(this.callbacks[I],d))),!this.isFullyInViewport&&K&&a(this.callbacks[J],d),!this.isInViewport&&c&&a(this.callbacks[I],d),this.isInViewport!==c&&a(this.callbacks[A],d),!0){case c!==this.isInViewport:case K!==this.isFullyInViewport:case u!==this.isAboveViewport:case w!==this.isBelowViewport:a(this.callbacks[y],d)}c=this.isInViewport,K=this.isFullyInViewport,u=this.isAboveViewport,w=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var f=this.top,v=this.bottom;if(this.watchItem.nodeName){var d=this.watchItem.style.display;"none"===d&&(this.watchItem.style.display="");for(var m=0,O=this.container;O.containerWatcher;){m+=O.containerWatcher.top-O.containerWatcher.container.viewportTop,O=O.containerWatcher.container}var o=this.watchItem.getBoundingClientRect();this.top=o.top+this.container.viewportTop-m,this.bottom=o.bottom+this.container.viewportTop-m,"none"===d&&(this.watchItem.style.display=d)}else{this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=this.container.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom)}this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===f&&void 0===v||this.top===f&&this.bottom===v||a(this.callbacks[C],null)}},this.recalculateLocation(),this.update(),c=this.isInViewport,K=this.isFullyInViewport,u=this.isAboveViewport,w=this.isBelowViewport}var q=D(1),A=q.VISIBILITYCHANGE,x=q.ENTERVIEWPORT,E=q.FULLYENTERVIEWPORT,I=q.EXITVIEWPORT,J=q.PARTIALLYEXITVIEWPORT,C=q.LOCATIONCHANGE,y=q.STATECHANGE,b=q.eventTypes,j=q.defaultOffsets;z.prototype={on:function(c,d,a){switch(!0){case c===A&&!this.isInViewport&&this.isAboveViewport:case c===x&&this.isInViewport:case c===E&&this.isFullyInViewport:case c===I&&this.isAboveViewport&&!this.isInViewport:case c===J&&this.isInViewport&&this.isAboveViewport:if(d.call(this,this.container.latestEvent,this),a){return}}if(!this.callbacks[c]){throw new Error("Tried to add a scroll monitor listener of type "+c+". Your options are: "+b.join(", "))}this.callbacks[c].push({callback:d,isOne:a||!1})},off:function(c,d){if(!this.callbacks[c]){throw new Error("Tried to remove a scroll monitor listener of type "+c+". Your options are: "+b.join(", "))}for(var a,f=0;a=this.callbacks[c][f];f++){if(a.callback===d){this.callbacks[c].splice(f,1);break}}},one:function(a,c){this.on(a,c,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<this.container.viewportTop,this.isBelowViewport=this.bottom>this.container.viewportBottom,this.isInViewport=this.top<this.container.viewportBottom&&this.bottom>this.container.viewportTop,this.isFullyInViewport=this.top>=this.container.viewportTop&&this.bottom<=this.container.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var c=this.container.watchers.indexOf(this),d=this;this.container.watchers.splice(c,1);for(var a=0,f=b.length;a<f;a++){d.callbacks[b[a]].length=0}},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var H=function(a){return function(d,c){this.on.call(this,a,d,c)}},F=0,B=b.length;F<B;F++){var g=b[F];z.prototype[g]=H(g)}k.exports=z}])});