(function(a){window.InlineShortcodeView_vc_tta_accordion=window.InlineShortcodeViewContainer.extend({events:{},childTag:"vc_tta_section",activeClass:"vc_active",defaultSectionTitle:window.i18nLocale.section,initialize:function(){_.bindAll(this,"buildSortable","updateSorting");window.InlineShortcodeView_vc_tta_accordion.__super__.initialize.call(this)},render:function(){window.InlineShortcodeViewContainer.__super__.render.call(this);this.content();this.buildPagination();return this},addControls:function(){this.$controls=a('<div class="no-controls"></div>');this.$controls.appendTo(this.$el);return this},addElement:function(b){b&&b.preventDefault();this.addSection("parent.prepend"===a(b.currentTarget).data("vcControl"))},appendElement:function(b){return this.addElement(b)},prependElement:function(b){return this.addElement(b)},addSection:function(b){var d,e,c;d=this.childTag;e={shortcode:d,parent_id:this.model.get("id"),isActiveSection:true,params:{title:this.defaultSectionTitle}};if(b){vc.activity="prepend";e.order=this.getSiblingsFirstPositionIndex()}vc.builder.create(e);for(c=vc.builder.models.length-1;c>=0;c--){d=vc.builder.models[c].get("shortcode")}vc.builder.render()},getSiblingsFirstPositionIndex:function(){var b,c;b=0;c=vc.shortcodes.sort().findWhere({parent_id:this.model.get("id")});if(c){b=c.get("order")-1}return b},changed:function(){vc.frame_window.vc_iframe.buildTTA();window.InlineShortcodeView_vc_tta_accordion.__super__.changed.call(this);_.defer(this.buildSortable);this.buildPagination()},updated:function(){window.InlineShortcodeView_vc_tta_accordion.__super__.updated.call(this);_.defer(this.buildSortable);this.buildPagination()},buildSortable:function(){if(!vc_user_access().shortcodeEdit(this.model.get("shortcode"))){return}if(this.$el){this.$el.find(".vc_tta-panels").sortable({forcePlaceholderSize:true,placeholder:"vc_placeholder-row",start:this.startSorting,over:function(b,c){c.placeholder.css({maxWidth:c.placeholder.parent().width()});c.placeholder.removeClass("vc_hidden-placeholder")},items:"> .vc_element",handle:".vc_tta-panel-heading, .vc_child-element-move",update:this.updateSorting})}},startSorting:function(b,c){c.placeholder.width(c.item.width())},updateSorting:function(c,d){var b=this;this.getPanelsList().find("> .vc_element").each(function(){var e,g,f;f=a(this);g=f.data("modelId");e=vc.shortcodes.get(g);e.save({order:b.getIndex(f)},{silent:true})});this.buildPagination()},getIndex:function(b){return b.index()},getPanelsList:function(){return this.$el.find(".vc_tta-panels")},parentChanged:function(){window.InlineShortcodeView_vc_tta_accordion.__super__.parentChanged.call(this);if("undefined"!==typeof(vc.frame_window.vc_round_charts)){vc.frame_window.vc_round_charts(this.model.get("id"))}if("undefined"!==typeof(vc.frame_window.vc_line_charts)){vc.frame_window.vc_line_charts(this.model.get("id"))}},buildPagination:function(){},removePagination:function(){this.$el.find(".vc_tta-panels-container").find(" > .vc_pagination").remove()},getPaginationList:function(){var g,c,f,d,b,e;e=this.model.get("params");if(!_.isUndefined(e.pagination_style)&&e.pagination_style.length){g=this.$el.find("[data-vc-accordion]");c=[];c.push("vc_general");c.push("vc_pagination");f=e.pagination_style.split("-");c.push("vc_pagination-style-"+f[0]);c.push("vc_pagination-shape-"+f[1]);if(!_.isUndefined(e.pagination_color)&&e.pagination_color.length){c.push("vc_pagination-color-"+e.pagination_color)}b=[];b.push('<ul class="'+c.join(" ")+'">');d=this;g.each(function(){var l,j,m,k,i,h;m=a(this);k=m.closest(".vc_tta-panel");j=k.hasClass(d.activeClass);l=["vc_pagination-item"];if(j){l.push(d.activeClass)}i=m.attr("href");if(0!==i.indexOf("#")){i=""}if(m.attr("data-vc-target")){i=m.attr("data-vc-target")}h='<a href="javascript:;" data-vc-target="'+i+'" class="vc_pagination-trigger" data-vc-tabs data-vc-container=".vc_tta"></a>';b.push('<li class="'+l.join(" ")+'" data-vc-tab>'+h+"</li>")});b.push("</ul>");return a(b.join(""))}return null}})})(window.jQuery);