(function(a){vc.events.on("shortcodeView:updated",function(b){var d,c;c=vc.map[b.get("shortcode")]||false;if(true===c.is_container){d=b.get("id");vc.frame_window.vc_iframe.updateChildGrids(d)}});window.InlineShortcodeViewContainer=window.InlineShortcodeView.extend({controls_selector:"#vc_controls-template-container",events:{"click > .vc_controls .vc_element .vc_control-btn-delete":"destroy","click > .vc_controls .vc_element .vc_control-btn-edit":"edit","click > .vc_controls .vc_element .vc_control-btn-clone":"clone","click > .vc_controls .vc_element .vc_control-btn-prepend":"prependElement","click > .vc_controls .vc_control-btn-append":"appendElement","click > .vc_empty-element":"appendElement",mouseenter:"resetActive",mouseleave:"holdActive"},hold_active:false,parent_view:false,initialize:function(b){_.bindAll(this,"holdActive");window.InlineShortcodeViewContainer.__super__.initialize.call(this,b);if(this.model.get("parent_id")){this.parent_view=vc.shortcodes.get(this.model.get("parent_id")).view}},resetActive:function(b){this.hold_active&&window.clearTimeout(this.hold_active)},holdActive:function(c){this.resetActive();this.$el.addClass("vc_hold-active");var b=this;this.hold_active=window.setTimeout(function(){b.hold_active&&window.clearTimeout(b.hold_active);b.hold_active=false;b.$el.removeClass("vc_hold-active")},700)},content:function(){if(false===this.$content){this.$content=this.$el.find(".vc_container-anchor:first").parent();this.$el.find(".vc_container-anchor:first").remove()}return this.$content},render:function(){window.InlineShortcodeViewContainer.__super__.render.call(this);this.content().addClass("vc_element-container");this.$el.addClass("vc_container-block");return this},changed:function(){if(this.allowAddControlOnEmpty()){(0===this.$el.find(".vc_element[data-tag]").length&&this.$el.addClass("vc_empty").find("> :first").addClass("vc_empty-element"))||this.$el.removeClass("vc_empty").find("> .vc_empty-element").removeClass("vc_empty-element")}},prependElement:function(b){_.isObject(b)&&b.preventDefault();this.prepend=true;vc.add_element_block_view.render(this.model,true)},appendElement:function(b){_.isObject(b)&&b.preventDefault();vc.add_element_block_view.render(this.model)},addControls:function(){var g,b,i,m,c,h,d,l,k,f;g=this.model.get("shortcode");l=a(this.controls_selector).html();var e;k=vc.shortcodes.get(this.model.get("parent_id"));if(k){e=vc.getMapped(k.get("shortcode")).name;b=k.get("shortcode")}i=vc_user_access().shortcodeAll(g);c=vc_user_access().shortcodeEdit(g);h=vc_user_access().shortcodeAll(b);d=vc_user_access().shortcodeEdit(b);m=vc_user_access().partAccess("dragndrop");f={name:vc.getMapped(g).name,tag:g,parent_name:e,parent_tag:b,can_edit:c,can_all:i,moveAccess:m,parent_can_edit:d,parent_can_all:h,state:vc_user_access().getState("shortcodes"),allowAdd:this.allowAddControl(),switcherPrefix:!h||!i?"-disable-switcher":""};var j=vc.template(_.unescape(l),_.extend({},vc.templateOptions.custom,{evaluate:/\{#([\s\S]+?)#}/g}));this.$controls=a(j(f).trim()).addClass("vc_controls");this.$controls.appendTo(this.$el)},allowAddControl:function(){return vc_user_access().getState("shortcodes")!=="edit"},multi_edit:function(d){var f=[],c,b;_.isObject(d)&&d.preventDefault();if(this.model.get("parent_id")){c=vc.shortcodes.get(this.model.get("parent_id"))}if(c){f.push(c);b=vc.shortcodes.where({parent_id:c.get("id")});vc.multi_edit_element_block_view.render(f.concat(b),this.model.get("id"))}else{vc.edit_element_block_view.render(this.model)}},allowAddControlOnEmpty:function(){return vc_user_access().getState("shortcodes")!=="edit"}})})(window.jQuery);