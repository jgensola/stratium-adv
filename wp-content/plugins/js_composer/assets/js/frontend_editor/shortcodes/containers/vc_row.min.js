(function(a){window.InlineShortcodeView_vc_row=window.InlineShortcodeView.extend({column_tag:"vc_column",events:{mouseenter:"removeHoldActive"},layout:1,addControls:function(){this.$controls=a('<div class="no-controls"></div>');this.$controls.appendTo(this.$el);return this},render:function(){var b=this.content();if(b&&b.hasClass("vc_row-has-fill")){b.removeClass("vc_row-has-fill");this.$el.addClass("vc_row-has-fill")}window.InlineShortcodeView_vc_row.__super__.render.call(this);return this},removeHoldActive:function(){vc.unsetHoldActive()},addColumn:function(){vc.builder.create({shortcode:this.column_tag,parent_id:this.model.get("id")}).render()},addElement:function(b){b&&b.preventDefault();this.addColumn()},changeLayout:function(b){b&&b.preventDefault();this.layoutEditor().render(this.model).show()},layoutEditor:function(){if(_.isUndefined(vc.row_layout_editor)){vc.row_layout_editor=new vc.RowLayoutUIPanelFrontendEditor({el:a("#vc_ui-panel-row-layout")})}return vc.row_layout_editor},convertToWidthsArray:function(b){return _.map(b.split(/_/),function(e){var d=e.split("");d.splice(Math.floor(e.length/2),0,"/");return d.join("")})},changed:function(){window.InlineShortcodeView_vc_row.__super__.changed.call(this);this.addLayoutClass()},content:function(){if(false===this.$content){this.$content=this.$el.find(".vc_container-anchor:first").parent()}this.$el.find(".vc_container-anchor:first").remove();return this.$content},addLayoutClass:function(){this.$el.removeClass("vc_layout_"+this.layout);this.layout=_.reject(vc.shortcodes.where({parent_id:this.model.get("id")}),function(b){return b.get("deleted")}).length;this.$el.addClass("vc_layout_"+this.layout)},convertRowColumns:function(f,d){if(!f){return false}var c,b,g,e;g=[];e=this.convertToWidthsArray(f);vc.layout_change_shortcodes=[];vc.layout_old_columns=vc.shortcodes.where({parent_id:this.model.get("id")});_.each(vc.layout_old_columns,function(h){h.set("deleted",true);g.push({shortcodes:vc.shortcodes.where({parent_id:h.get("id")}),params:h.get("params")})});_.each(e,function(i){var h=g.shift();if(_.isObject(h)){b=d.create({shortcode:this.column_tag,parent_id:this.model.get("id"),order:vc.shortcodes.nextOrder(),params:_.extend({},h.params,{width:i})}).last();_.each(h.shortcodes,function(j){j.save({parent_id:b.get("id"),order:vc.shortcodes.nextOrder()},{silent:true});vc.layout_change_shortcodes.push(j)},this)}else{c={width:i};b=d.create({shortcode:this.column_tag,parent_id:this.model.get("id"),order:vc.shortcodes.nextOrder(),params:c}).last()}},this);_.each(g,function(h){_.each(h.shortcodes,function(i){i.save({parent_id:b.get("id"),order:vc.shortcodes.nextOrder()},{silent:true});vc.layout_change_shortcodes.push(i);i.view.rowsColumnsConverted&&i.view.rowsColumnsConverted()},this)},this);d.render(function(){_.each(vc.layout_change_shortcodes,function(h){h.trigger("change:parent_id");h.view.rowsColumnsConverted&&h.view.rowsColumnsConverted()});_.each(vc.layout_old_columns,function(h){h.destroy()});vc.layout_old_columns=[];vc.layout_change_shortcodes=[]});return e},allowAddControl:function(){return vc_user_access().getState("shortcodes")!=="edit"},allowAddControlOnEmpty:function(){return vc_user_access().getState("shortcodes")!=="edit"}})})(window.jQuery);