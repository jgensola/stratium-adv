!function(b){function c(f,d){this.element=b(f),this.settings=b.extend({},a,d),this.settings.emptyIcon&&this.settings.iconsPerPage--,this.iconPicker=b("<div/>",{"class":this.settings.mainClass,style:"position: relative",html:'<div class="selector"><span class="selected-icon"><i class="fip-block-icon '+this.settings.iconBlockClass+'"></i></span><span class="selector-button"><i class="'+this.settings.iconDownClass+'"></i></span></div><div class="selector-popup" style="display: none;">'+(this.settings.hasSearch?'<div class="selector-search"><input type="text" name="" value="" placeholder="'+this.settings.searchPlaceholder+'" class="icons-search-input"/><i class="'+this.settings.iconSearchClass+'"></i></div>':"")+'<div class="selector-category"><select name="" class="icon-category-select" style="display: none"></select></div><div class="fip-icons-container"></div><div class="selector-footer" style="display:none;"><span class="selector-pages">1/2</span><span class="selector-arrows"><span class="selector-arrow-left" style="display:none;"><i class="'+this.settings.iconLeftClass+'"></i></span><span class="selector-arrow-right"><i class="'+this.settings.iconRightClass+'"></i></span></span></div></div>'}),this.iconContainer=this.iconPicker.find(".fip-icons-container"),this.searchIcon=this.iconPicker.find(".selector-search i"),this.iconsSearched=[],this.isSearch=!1,this.totalPage=1,this.currentPage=1,this.currentIcon=!1,this.initialized=!1,this.iconsPaged=!1,this.iconsCount=0,this.open=!1,this.searchValues=[],this.availableCategoriesSearch=[],this.triggerEvent=null,this.backupSource=[],this.backupSearch=[],this.isCategorized=!1,this.selectCategory=this.iconPicker.find(".icon-category-select"),this.selectedCategory=!1,this.availableCategories=[],this.unCategorizedKey=null,this.quickInit()}var a={theme:"fip-vc-theme-grey",source:!1,emptyIcon:!0,emptyIconValue:"",iconsPerPage:20,hasSearch:!0,searchSource:!1,useAttribute:!1,attributeName:"data-icon",convertToHex:!0,allCategoryText:"From all categories",unCategorizedText:"Uncategorized",iconDownClass:"fip-icon-down-dir",iconUpClass:"fip-icon-up-dir",iconLeftClass:"fip-icon-left-dir",iconRightClass:"fip-icon-right-dir",iconSearchClass:"fip-icon-search",iconCancelClass:"fip-icon-cancel",iconSpinClass:"fip-icon-spin3",iconBlockClass:"fip-icon-block",searchPlaceholder:"Search Icon",mainClass:"vc-icons-selector"};c.prototype={quickInit:function(){var g=!0;this.iconPicker.addClass(this.settings.theme),this.iconPicker.css({left:-9999}).appendTo("body");var d=this.iconPicker.outerHeight(),f=this.iconPicker.outerWidth();if(this.iconPicker.css({left:""}),this.element.before(this.iconPicker),this.element.css({visibility:"hidden",top:0,position:"relative",zIndex:"-1",left:"-"+f+"px",display:"none",height:d+"px",width:f+"px",padding:"0",margin:"0 -"+f+"px 0 0",border:"0 none",verticalAlign:"top"}).hide(),!this.element.is("select")){var j=function(){for(var l=3,m=document.createElement("div"),k=m.all||[];m.innerHTML="<!--[if gt IE "+ ++l+"]><br><![endif]-->",k[0];){}return l>4?l:!l}(),h=document.createElement("div");this.triggerEvent=9!==j&&"oninput" in h?["input","keyup"]:["keyup"]}this.setSelectedIcon(this.element.val()),this.selectCategory.on("change keyup",b.proxy(function(m){if(this.isCategorized===!1){return !1}var k=b(m.currentTarget),l=k.val();if("all"===k.val()){this.settings.source=this.backupSource,this.searchValues=this.backupSearch}else{var o=parseInt(l,10);this.availableCategories[o]&&(this.settings.source=this.availableCategories[o],this.searchValues=this.availableCategoriesSearch[o])}this.resetSearch(),this.loadIcons()},this)),this.iconPicker.find(".selector-button").click(b.proxy(function(){!this.open&&g&&(g=!1,this.initCategories()),this.toggleIconSelector()},this)),this.iconPicker.find(".selector-arrow-right").click(b.proxy(function(i){this.currentPage<this.totalPage&&(this.iconPicker.find(".selector-arrow-left").show(),this.currentPage=this.currentPage+1,this.renderIconContainer(),this.renderIcons()),this.currentPage===this.totalPage&&b(i.currentTarget).hide()},this)),this.iconPicker.find(".selector-arrow-left").click(b.proxy(function(i){this.currentPage>1&&(this.iconPicker.find(".selector-arrow-right").show(),this.currentPage=this.currentPage-1,this.renderIconContainer(),this.renderIcons()),1===this.currentPage&&b(i.currentTarget).hide()},this)),this.iconPicker.find(".icons-search-input").keyup(b.proxy(function(l){var k=b(l.currentTarget).val();return""===k?void this.resetSearch():(this.searchIcon.removeClass(this.settings.iconSearchClass),this.searchIcon.addClass(this.settings.iconCancelClass),this.isSearch=!0,this.currentPage=1,this.iconsSearched=[],b.grep(this.searchValues,b.proxy(function(i,m){return i.toLowerCase().search(k.toLowerCase())<0?void 0:(this.iconsSearched[this.iconsSearched.length]=this.settings.source[m],!0)},this)),this.iconsSearched=this.iconsSearched.filter(this.getOnlyUnique),this.renderIconContainer(),void this.renderIcons())},this)),this.iconPicker.find(".selector-search i").on("click",b.proxy(function(){this.iconPicker.find(".icons-search-input").focus(),this.resetSearch()},this)),this.iconContainer.on("click",".fip-box",b.proxy(function(i){this.setSelectedIcon(b(i.currentTarget).find("i").attr("data-fip-value")),this.toggleIconSelector()},this)),this.iconPicker.click(function(e){return e.stopPropagation(),!1}),b("html").click(b.proxy(function(){this.open&&this.toggleIconSelector()},this))},init:function(){this.iconPicker.addClass(this.settings.theme),this.iconPicker.css({left:-9999}).appendTo("body");var g=this.iconPicker.outerHeight(),d=this.iconPicker.outerWidth();if(this.iconPicker.css({left:""}),this.element.before(this.iconPicker),this.element.css({visibility:"hidden",top:0,position:"relative",zIndex:"-1",left:"-"+d+"px",display:"none",height:g+"px",width:d+"px",padding:"0",margin:"0 -"+d+"px 0 0",border:"0 none",verticalAlign:"top"}).hide(),!this.element.is("select")){var f=function(){for(var k=3,l=document.createElement("div"),j=l.all||[];l.innerHTML="<!--[if gt IE "+ ++k+"]><br><![endif]-->",j[0];){}return k>4?k:!k}(),h=document.createElement("div");this.triggerEvent=9!==f&&"oninput" in h?["input","keyup"]:["keyup"]}this.initCategories(),this.selectCategory.on("change keyup",b.proxy(function(l){if(this.isCategorized===!1){return !1}var j=b(l.currentTarget),k=j.val();if("all"===j.val()){this.settings.source=this.backupSource,this.searchValues=this.backupSearch}else{var m=parseInt(k,10);this.availableCategories[m]&&(this.settings.source=this.availableCategories[m],this.searchValues=this.availableCategoriesSearch[m])}this.resetSearch(),this.loadIcons()},this)),this.iconPicker.find(".selector-button").click(b.proxy(function(){this.toggleIconSelector()},this)),this.iconPicker.find(".selector-arrow-right").click(b.proxy(function(i){this.currentPage<this.totalPage&&(this.iconPicker.find(".selector-arrow-left").show(),this.currentPage=this.currentPage+1,this.renderIconContainer(),this.renderIcons()),this.currentPage===this.totalPage&&b(i.currentTarget).hide()},this)),this.iconPicker.find(".selector-arrow-left").click(b.proxy(function(i){this.currentPage>1&&(this.iconPicker.find(".selector-arrow-right").show(),this.currentPage=this.currentPage-1,this.renderIconContainer(),this.renderIcons()),1===this.currentPage&&b(i.currentTarget).hide()},this)),this.iconPicker.find(".icons-search-input").keyup(b.proxy(function(k){var j=b(k.currentTarget).val();return""===j?void this.resetSearch():(this.searchIcon.removeClass(this.settings.iconSearchClass),this.searchIcon.addClass(this.settings.iconCancelClass),this.isSearch=!0,this.currentPage=1,this.iconsSearched=[],b.grep(this.searchValues,b.proxy(function(i,l){return i.toLowerCase().search(j.toLowerCase())<0?void 0:(this.iconsSearched[this.iconsSearched.length]=this.settings.source[l],!0)},this)),this.iconsSearched=this.iconsSearched.filter(this.getOnlyUnique),this.renderIconContainer(),void this.renderIcons())},this)),this.iconPicker.find(".selector-search i").on("click",b.proxy(function(){this.iconPicker.find(".icons-search-input").focus(),this.resetSearch()},this)),this.iconContainer.on("click",".fip-box",b.proxy(function(i){this.setSelectedIcon(b(i.currentTarget).find("i").attr("data-fip-value")),this.toggleIconSelector()},this)),this.iconPicker.click(function(e){return e.stopPropagation(),!1}),b("html").click(b.proxy(function(){this.open&&this.toggleIconSelector()},this))},initCategories:function(){!this.settings.source&&this.element.is("select")?(this.settings.source=[],this.settings.searchSource=[],this.element.find("optgroup").length?(this.isCategorized=!0,this.element.find("optgroup").each(b.proxy(function(g,d){var f=this.availableCategories.length,h=b("<option />");h.attr("value",f),h.html(b(d).attr("label")),this.selectCategory.append(h),this.availableCategories[f]=[],this.availableCategoriesSearch[f]=[],b(d).find("option").each(b.proxy(function(k,j){var m=b(j).val(),l=b(j).html();m&&m!==this.settings.emptyIconValue&&(this.settings.source.push(m),this.availableCategories[f].push(m),this.searchValues.push(l),this.availableCategoriesSearch[f].push(l))},this))},this)),this.element.find("> option").length&&this.element.find("> option").each(b.proxy(function(g,d){var f=b(d).val(),h=b(d).html();return f&&""!==f&&f!=this.settings.emptyIconValue?(null===this.unCategorizedKey&&(this.unCategorizedKey=this.availableCategories.length,this.availableCategories[this.unCategorizedKey]=[],this.availableCategoriesSearch[this.unCategorizedKey]=[],b("<option />").attr("value",this.unCategorizedKey).html(this.settings.unCategorizedText).appendTo(this.selectCategory)),this.settings.source.push(f),this.availableCategories[this.unCategorizedKey].push(f),this.searchValues.push(h),void this.availableCategoriesSearch[this.unCategorizedKey].push(h)):!0},this))):this.element.find("option").each(b.proxy(function(g,d){var f=b(d).val(),h=b(d).html();f&&(this.settings.source.push(f),this.searchValues.push(h))},this)),this.backupSource=this.settings.source.slice(0),this.backupSearch=this.searchValues.slice(0),this.loadCategories()):this.initSourceIndex(),this.loadIcons()},getOnlyUnique:function(f,g,d){return d.indexOf(f)===g},initSourceIndex:function(){if("object"==typeof this.settings.source){if(b.isArray(this.settings.source)){this.isCategorized=!1,this.selectCategory.html("").hide(),this.settings.source=b.map(this.settings.source,function(e){return"function"==typeof e.toString?""+e:e}),this.searchValues=b.isArray(this.settings.searchSource)?b.map(this.settings.searchSource,function(e){return"function"==typeof e.toString?""+e:e}):this.settings.source.slice(0)}else{var h=b.extend(!0,{},this.settings.source);this.settings.source=[],this.searchValues=[],this.availableCategoriesSearch=[],this.selectedCategory=!1,this.availableCategories=[],this.unCategorizedKey=null,this.isCategorized=!0,this.selectCategory.html("");for(var d in h){var f=this.availableCategories.length,l=b("<option />");l.attr("value",f),l.html(d),this.selectCategory.append(l),this.availableCategories[f]=[],this.availableCategoriesSearch[f]=[];for(var k in h[d]){var g=h[d][k],j=this.settings.searchSource&&this.settings.searchSource[d]&&this.settings.searchSource[d][k]?this.settings.searchSource[d][k]:g;"function"==typeof g.toString&&(g=""+g),g&&g!==this.settings.emptyIconValue&&(this.settings.source.push(g),this.availableCategories[f].push(g),this.searchValues.push(j),this.availableCategoriesSearch[f].push(j))}}}this.backupSource=this.settings.source.slice(0),this.backupSearch=this.searchValues.slice(0),this.loadCategories()}},loadCategories:function(){this.isCategorized!==!1&&(b('<option value="all">'+this.settings.allCategoryText+"</option>").prependTo(this.selectCategory),this.selectCategory.show().val("all").trigger("change"))},loadIcons:function(){this.iconContainer.html('<i class="'+this.settings.iconSpinClass+' animate-spin loading"></i>'),this.settings.source instanceof Array&&(this.renderIconContainer(),this.renderIcons(),this.setContainerSelectedItems())},renderIconContainer:function(){var d,f=[];if(f=this.isSearch?this.iconsSearched:this.settings.source,this.iconsCount=f.length,this.totalPage=Math.ceil(this.iconsCount/this.settings.iconsPerPage),this.totalPage>1?this.iconPicker.find(".selector-footer").show():this.iconPicker.find(".selector-footer").hide(),this.iconPicker.find(".selector-pages").html(this.currentPage+"/"+this.totalPage+" <em>("+this.iconsCount+")</em>"),d=(this.currentPage-1)*this.settings.iconsPerPage,this.settings.emptyIcon){this.iconContainer.html('<span class="fip-box"><i class="fip-block-icon '+this.settings.iconBlockClass+'" data-fip-value="'+this.settings.iconBlockClass+'"></i></span>')}else{if(f.length<1){return void this.iconContainer.html('<span class="icons-picker-error"><i class="fip-block-icon '+this.settings.iconBlockClass+'" data-fip-value="'+this.settings.iconBlockClass+'"></i></span>')}this.iconContainer.html("")}f=f.slice(d,d+this.settings.iconsPerPage),this.iconsPaged=f},setContainerSelectedItems:function(){this.settings.emptyIcon||this.element.val()&&-1!==b.inArray(this.element.val(),this.settings.source)?-1===b.inArray(this.element.val(),this.settings.source)?this.setSelectedIcon():this.setSelectedIcon(this.element.val()):this.setSelectedIcon(this.iconsPaged[0])},setHighlightedIcon:function(){this.iconContainer.find(".current-icon").removeClass("current-icon"),this.currentIcon&&this.iconContainer.find('[data-fip-value="'+this.currentIcon+'"]').parent("span").addClass("current-icon")},setSelectedIcon:function(d){if(d===this.settings.iconBlockClass&&(d=""),this.iconPicker.find(".selected-icon").html(this.settings.useAttribute?d?"<i "+this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(d,10).toString(16)+";":d)+'"></i>':'<i class="fip-block-icon '+this.settings.iconBlockClass+'"></i>':'<i class="'+(d||"fip-block-icon "+this.settings.iconBlockClass)+'"></i>'),this.element.val(""===d?this.settings.emptyIconValue:d).trigger("change"),null!==this.triggerEvent){for(var f in this.triggerEvent){this.element.trigger(this.triggerEvent[f])}}this.currentIcon=d,this.setHighlightedIcon()},toggleIconSelector:function(){this.open=this.open?0:1,this.iconPicker.find(".selector-popup").slideToggle(300),this.iconPicker.find(".selector-button i").toggleClass(this.settings.iconDownClass),this.iconPicker.find(".selector-button i").toggleClass(this.settings.iconUpClass),this.open&&(this.iconPicker.find(".icons-search-input").focus().select(),this.initialized||(this.renderIconContainer(),this.renderIcons(),this.initialized=!0))},renderIcons:function(){for(var g=0;g<this.iconsPaged.length;g++){var d=this.iconsPaged[g],f=d;b.grep(this.settings.source,b.proxy(function(h,i){return h===d?(f=this.searchValues[i],!0):!1},this)),b("<span/>",{html:'<i data-fip-value="'+d+'" '+(this.settings.useAttribute?this.settings.attributeName+'="'+(this.settings.convertToHex?"&#x"+parseInt(d,10).toString(16)+";":d)+'"':'class="'+d+'"')+"></i>","class":"fip-box",title:f}).appendTo(this.iconContainer)}this.setContainerSelectedItems()},resetSearch:function(){this.iconPicker.find(".icons-search-input").val(""),this.searchIcon.removeClass(this.settings.iconCancelClass),this.searchIcon.addClass(this.settings.iconSearchClass),this.iconPicker.find(".selector-arrow-left").hide(),this.currentPage=1,this.isSearch=!1,this.renderIconContainer(),this.renderIcons(),this.totalPage>1&&this.iconPicker.find(".selector-arrow-right").show()}},b.fn.vcFontIconPicker=function(d){return this.each(function(){b.data(this,"vcFontIconPicker")||b.data(this,"vcFontIconPicker",new c(this,d))}),this.setIcons=b.proxy(function(g,f){void 0===g&&(g=!1),void 0===f&&(f=!1),this.each(function(){b.data(this,"vcFontIconPicker").settings.source=g,b.data(this,"vcFontIconPicker").settings.searchSource=f,b.data(this,"vcFontIconPicker").initSourceIndex(),b.data(this,"vcFontIconPicker").resetSearch(),b.data(this,"vcFontIconPicker").loadIcons()})},this),this.destroyPicker=b.proxy(function(){this.each(function(){b.data(this,"vcFontIconPicker")&&(b.data(this,"vcFontIconPicker").iconPicker.remove(),b.data(this,"vcFontIconPicker").element.css({visibility:"",top:"",position:"",zIndex:"",left:"",display:"block",height:"",width:"",padding:"",margin:"",border:"",verticalAlign:""}).show(),b.removeData(this,"vcFontIconPicker"))})},this),this.refreshPicker=b.proxy(function(e){e||(e=d),this.destroyPicker(),this.each(function(){b.data(this,"vcFontIconPicker")||b.data(this,"vcFontIconPicker",new c(this,e))})},this),this}}(jQuery);