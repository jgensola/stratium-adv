(function(aq){var ak,Y=tg_admin_global_var.box_messages,f=tg_admin_global_var.box_icons;function at(aI){if(ak&&(ak.readyState==3||ak.readyState==2||ak.readyState==1)){return false}var aK=Y[aI.func];var aJ=aI.callbacks;delete aI.callbacks;ak=aq.ajax({url:ajaxurl,type:"POST",dataType:"json",data:aI,beforeSend:function(){var aL=f.before+aK.before;if(aJ.before){aJ.before(aI,aL)}},error:function(aL){console.error(aL);if(aJ.error){aJ.error(aI,aL)}},success:function(aL){if(!aL.success){if(aJ.error){aJ.error(aI,aL)}return false}else{var aM=f.success+aK.success;if(aJ.success){aJ.success(aI,aL,aM)}}}})}window.TG_metaData=function(aJ){var aI={},aK;aJ.each(function(){var aM=aq(this),aL=aM.find("[name]").attr("name");aL=(aL)?aL:"";aL=aL.replace("[]","");if(aM.is(".tomb-type-radio")){aK=aM.find("[name]:checked").val()}else{if(aM.is(".tomb-type-image_select")){aK=aM.find("input:checked").val()}else{if(aM.is(".tomb-type-number")){aK=aM.find("input").val();aK=(aK=="0")?"00":aK}else{if(aM.is(".tomb-type-checkbox")){aK=aM.find("input").is(":checked");aK=(aK)?aK:null}else{if(aM.is(".tomb-type-checkbox_list")){aK=[];aM.find(".tomb-checkbox-list:checked").each(function(){aK.push(aq(this).val())})}else{aK=aM.find("[name]").val()}}}}}if(aL!==""){aI[aL]=aK}});return aI};window.TG_field_value=function(aI,aK){var aJ={};aI.find(".tomb-row input, .tomb-row select, .tomb-row textarea").each(function(){var aN=aq(this),aM,aL=aN.attr("name");if(aN.is(":radio")){aM=aN.closest(".tomb-row").find("[name]:checked").val()}else{if(aN.is(":checkbox")){aM=aN.is(":checked");aM=(aM)?true:""}else{aM=aN.val()}}if(aL){aJ[aL.replace(aK,"")]=aM}});return aJ};window.TG_element_color=function(aO,aM){var aQ,aJ=(aM&&aM.source)?aM.source:[],aN=(aJ&&aJ.hasOwnProperty("html_tag"))?aJ.html_tag:"",aP=(aJ&&aJ.hasOwnProperty("source_type"))?aJ.source_type:"",aL=(aJ&&aJ.hasOwnProperty("post_content"))?aJ.post_content:"",aK=(aJ&&aJ.hasOwnProperty("video_stream_content"))?aJ.video_stream_content:"",aI=(aJ&&aJ.hasOwnProperty("woocommerce_content"))?aJ.woocommerce_content:"";if(aN&&aP!=="line_break"){aQ="tg-"+aN.replace(/\d+/g,"")+"-tag"}else{if(aP==="post"){switch(aL){case"get_the_title":aQ="tg-h-tag";break;case"get_the_excerpt":aQ="tg-p-tag";break;case"get_the_date":aQ="tg-span-tag";break;case"get_the_author":aQ="tg-span-tag";break;case"get_the_comments_number":aQ="tg-span-tag";break;case"get_the_likes_number":aQ="tg-span-tag";break;case"get_the_terms":aQ="tg-span-tag";break;case"get_item_meta":aQ="tg-span-tag";break;default:aQ="tg-p-tag"}}else{if(aP==="video_stream"){switch(aK){case"get_the_views_number":aQ="tg-span-tag";break;case"get_the_duration":aQ="tg-div-tag";break;default:aQ="tg-span-tag"}}else{if(aP==="woocommerce"){switch(aI){case"get_product_price":aQ="tg-div-tag";break;case"get_product_full_price":aQ="tg-div-tag";break;case"get_product_regular_price":aQ="tg-div-tag";break;case"get_product_sale_price":aQ="tg-div-tag";break;case"get_product_add_to_cart_url":aQ="tg-div-tag";break;default:aQ="tg-span-tag"}}else{if(aP==="media_button"){aQ="tg-div-tag"}else{if(aP==="social_link"){aQ="tg-div-tag"}else{if(aP==="icon"){aQ="tg-div-tag"}else{if(aP==="html"){aQ="tg-div-tag"}else{if(aP==="line_break"){aQ="tg-line-break"}}}}}}}}}aq(".tg-element-draggable"+aO+", .tg-element-custom"+aO).removeClass("tg-h-tag tg-div-tag tg-p-tag tg-span-tag tg-line-break").addClass(aQ)};function m(aI){var aL=decodeURIComponent(window.location.search.substring(1)),aK=aL.split("&"),aM,aJ;for(aJ=0;aJ<aK.length;aJ++){aM=aK[aJ].split("=");if(aM[0]===aI){return aM[1]===undefined?true:aM[1]}}}var ao=aq("#tg-banner-holder"),aC=aq("#tg-banner"),G="tg-fixed",n=aq("#wpadminbar").height(),ai;if(aC.hasClass("tg-banner-sticky")){aq(document).ready(function(aI){aC.width(ao.width())});aq(document).on("click",".tomb-menu-options .tomb-tab",function(){setTimeout(function(){aC.width(ao.width())},100)});aq(window).on("resize",function(){aC.width(ao.width())});aq(document).scroll(function(){ai=ao.offset().top-n;if(ai<=aq(document).scrollTop()){aC.addClass(G)}else{aC.removeClass(G)}})}var h="#tg-info-box",o=".tg-info-box-msg",al="tg-box-loading";aq(document).on("click",h,function(aI){if(aq(h).is(":visible")&&(aq(aI.target).is(".tg-info-inner")||aq(aI.target).is(".tg-close-infox-box"))){aq(h).removeClass(al);setTimeout(function(){aq(h).removeClass(al)},300)}});var au="#tg-grid-list-holder",u="#tg-grid-list-wrap",K=au+" .tg-sort-table span",aA=au+" .tg-grid-list-favorite i",D=au+" .page-numbers:not(.current)",X=au+" .tg-list-number",aG=au+" .tg-clone",af=au+" .tg-delete",i=K+","+aA+","+D+","+aG+","+af;aq(document).on("click",i,function(aJ){aJ.preventDefault();var aI;if(aq(this).hasClass("tg-delete")){aI=confirm(tg_admin_global_var.box_messages.tg_delete.message);if(!aI){return false}}else{if(aq(this).hasClass("tg-clone")){aI=confirm(tg_admin_global_var.box_messages.tg_clone.message);if(!aI){return false}}}at(O(aq(this)))});aq(document).on("change",X,function(aI){aI.preventDefault();at(O(aq(this)))});function O(aI){return{nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aI.data("action"),orderby:aI.closest("th").data("orderby"),order:aI.data("order"),number:aI.val(),page_nb:aI.data("page-nb"),post_ID:aI.data("grid-id"),meta_data:aI.data("favorite"),callbacks:{before:g,success:c,error:F}}}function g(aI,aJ){aq(o).html(aJ);aq(h).addClass(al)}function F(aI,aJ){aq(o).html(tg_admin_global_var.box_icons.error+aJ.message);setTimeout(function(){aq(h).removeClass(al)},1500)}function c(aI,aJ,aK){aq(o).html(aK);setTimeout(function(){aq(h).removeClass(al);setTimeout(function(){var aL=aq(aJ.content).html();aq(u).html(aL);if(aI.func==="tg_clone"){aq(au+" .wp-list-table tbody tr").first().addClass("cloned")}},300)},800)}aq(document).on("click","#tg_post_save",function(aJ){aJ.preventDefault();var aI={nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aq(this).data("action"),post_ID:aq("#post_ID").attr("value"),meta_data:JSON.stringify(TG_metaData(aq("#the_grid_metabox .tomb-row"))),callbacks:{before:g,success:am,error:j}};at(aI)});function j(aI,aJ){aq(o).html(aJ.message)}function am(aI,aJ,aK){aq(o).html(aK);setTimeout(function(){if(aJ.content){aq("#post_ID").attr("value",aJ.content);aq("#the_grid_id").val("grid-"+aJ.content);var aL=window.location.href,aM=aL.substr(aL.lastIndexOf("/")+1);aL=aL.replace(aM,"admin.php?page=the_grid_settings&id="+aJ.content);if(history.pushState){history.pushState(null,null,aL)}else{window.location.href=aL}}aq(h).removeClass(al)},800)}aq(document).on("click","#tg_post_delete",function(aK){aK.preventDefault();var aI=confirm(tg_admin_global_var.box_messages.tg_delete.message);if(!aI){return false}var aJ={nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aq(this).data("action"),post_ID:aq("#post_ID").attr("value"),callbacks:{before:g,success:R,error:F}};at(aJ)});function R(aI,aJ,aK){aq(o).html(aK);aq("#tg_post_close")[0].click()}var aE=".tg-meta-key-holder",r=".tg-meta-name",b=".tg-meta-key-name",ar=".the_grid_custom_meta_data",aB="#tg_settings_add_metadata",q="#tg_settings_remove_metadata";aq(aB).on("click",function(){var aJ=aq(this).closest(".tomb-row"),aI=aq(aE).eq(0).clone();aI.find("input").val("");aI.find(q).show();aI.insertBefore(aJ)});aq(document).on("click",q,function(){aq(this).closest(aE).remove();aD()});aq(document).on("change",r+","+b,function(){aD()});function aD(){var aI=[];aq(aE).each(function(aK){var aM=aq(this),aJ=aM.find(r).val(),aL=aM.find(b).val();if(aJ){aI[aK]={};aI[aK].name=aJ;aI[aK].key=aL}});aq(ar).attr("value",JSON.stringify(aI))}aq(document).on("click","#tg_settings_save, #tg_settings_reset",function(){if(aq(this).is("#tg_settings_reset")){var aJ=confirm(tg_admin_global_var.box_messages.tg_reset_settings.message);if(!aJ){return false}}var aL=aq(this).data("action"),aK=(aL==="tg_reset_settings")?true:null,aI=aw(aK);at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aL,reset:aK,setting_data:JSON.stringify(aI),callbacks:{before:g,success:J,error:F}})});function aw(aK){var aI={},aJ;aq(".tomb-row").each(function(){var aL=aq(this).find("[name]");if(aL.length){var aM=aL.attr("name");if(aK){aJ=aL.data("default")}else{aJ=aL.val();if(aL.is(".tomb-checkbox")){aJ=aL.is(":checked");aJ=(aJ)?aJ:null}}aI[aM]=aJ}});return aI}function J(aI,aJ,aK){aq(o).html(aK);setTimeout(function(){aq(h).removeClass(al);if(aJ.content){aq(".metabox-holder.tg-settings").html(aq(aJ.content).html());TOMB_JS.init()}},800)}var E="#tg_clear_cache_msg .spinner",S="#tg_clear_cache_msg strong";aq(document).on("click","#tg_clear_cache",function(){at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aq(this).data("action"),callbacks:{before:function(aI,aJ){aq(E).css("visibility","visible").show();aq(S).html(Y[aI.func].before)},success:function(aI,aJ,aK){aq(E).css("visibility","hidden").hide();aq(S).html(Y[aI.func].success)},error:function(aI,aJ){aq(E).css("visibility","hidden").hide();aq(S).html(aJ.error)}}})});aq(document).on("click","#tg_export_items",function(){aq(".tg-export-msg").html("");var aI={};aq(".tg-export .tg-list-item-holder li").each(function(){var aJ=aq(this);if(aJ.hasClass("selected")){aI[aJ.data("type")]=(aI[aJ.data("type")])?aI[aJ.data("type")]:{};aI[aJ.data("type")][aJ.data("name")]=aJ.data("id")}});if(!aq.isEmptyObject(aI)){aq(o).html(f.before+Y.tg_export_items.before);aq(h).addClass(al);aq('[name="tg_export_items"]').val(JSON.stringify(aI));aq('[name="tg_export_items"]').trigger("click");setTimeout(function(){aq(o).html(f.success+Y.tg_export_items.success);setTimeout(function(){aq(h).removeClass(al)},800)},800)}else{aq(".tg-export-msg").html(Y.tg_export_items.empty);setTimeout(function(){aq(".tg-export-msg").html("")},1500)}});aq(document).on("click",'.tg-list-item-wrapper[data-multi-select="1"] .tg-list-item-holder li',function(){aq(this).toggleClass("selected")});aq(document).on("keyup",".tg-list-item-search",function(){var aI=aq(this).val();L(aI)});aq(document).on("click",".tg-list-item-add-all",function(){aq(this).prevAll(".tg-list-item-wrapper").find(".tg-list-item-holder li").addClass("selected")});aq(document).on("click",".tg-list-item-clear",function(){aq(this).prevAll(".tg-list-item-wrapper").find(".tg-list-item-holder li").removeClass("selected")});function L(aI){aq(".tg-list-item-holder li").each(function(aJ,aL){var aM=aq(this);var aK=aM.text();if(aK.toLowerCase().indexOf(aI)>=0){aM.show()}else{aM.hide()}})}var U=null,N=".tg-import-content",ad=".tg-import-loading .spinner",aH='#tg-import-file[type="file"]',d=".tg-import-msg-success",az=".tg-import-item-msg-error",ac=".tg-import-msg-error";aq(document).on("click","#tg_import_items, #tg-import-demo",function(){var aI=[];var aJ=0;aq(".tg-import .tg-list-item-holder li").each(function(aK,aL){if(aq(this).hasClass("selected")){aI[aJ]=aq(aL).data("name");aJ++}});if(aI.length!==0||aq(this).data("grid-demo")){at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aq(this).data("action"),item_data:U,item_names:aI,grid_demo:aq(this).data("grid-demo"),callbacks:{before:g,success:function(aK,aL,aM){aq(o).html(aM);setTimeout(function(){aq(h).removeClass(al);if(aL.content){var aN=aq(aL.content).html();aq(u).html(aN)}},800)},error:F}})}else{aq(az).html(Y.tg_import_items.empty);setTimeout(function(){aq(az).html("")},1500)}});aq(document).on("click","#tg-import-read-demo",function(){Z();var aJ=aq(this).data("action"),aI={nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aJ,demo:true};l(aI,"application/x-www-form-urlencoded; charset=UTF-8",true,aJ)});aq(document).on("click","#tg-import-read-file",function(aM){Z();var aI=new FormData(),aL=aq(this).data("action"),aK=aq(document).find(aH),aJ=aK[0].files[0];if(!aJ){aq(ac).html(Y[aL].empty);return false}aI.append("file",aJ);aI.append("action","backend_grid_ajax");aI.append("nonce",tg_admin_global_var.nonce);aI.append("func",aL);l(aI,false,false,aL)});function l(aI,aL,aK,aJ){aq.ajax({type:"POST",url:ajaxurl,dataType:"json",data:aI,contentType:aL,processData:aK,beforeSend:function(aM){aq(d).html(Y[aJ].before);aq(ad).show()},error:function(aM){aq(ac).html(aM.message);aq(ad).hide()},success:function(aM){aq(ad).hide();if(!aM.success){aq(d).html("");aq(ac).html(aM.message)}else{aq(N).html(aM.content);aq(d).html("");U=aM.message}}})}function Z(){U=null;aq(N).add(ac).add(d).html("")}var T,w,M=aq(".the_grid_source_type.tomb-type-image_select"),Q=aq("#tg-grid-skins"),p=aq("#tg-grid-skins-loading"),t=aq(".the_grid_style input:checked").val(),C=(t==="justified")?"grid":t,k=(typeof tg_admin_global_var.default_skin!=="undefined")?tg_admin_global_var.default_skin.masonry:null,x=(typeof tg_admin_global_var.default_skin!=="undefined")?tg_admin_global_var.default_skin.grid:null,an=(C==="grid")?x:k,av=aq.parseJSON(aq(".tomb-grid-skins").val());av=(av&&!aq.isEmptyObject(av))?av:{};aq(".tomb-tab-content.tomb-tab-7").find("#section_skins_start").addClass("has-grid-skin");if(aq("#tg-grid-skins").length>0){at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_skin_selector",post_ID:aq("#post_ID").attr("value"),callbacks:{before:function(aI,aJ,aK){p.html(Y.tg_skin_selector.before)},success:function(aI,aK,aL){if(!aK.success){p.removeClass("loading-anim").html(aK.message);return false}Q.html(aK.content).find(".tg-grid-holder").The_Grid();Q.find('[data-filter=".selected"] .tg-filter-count').html(1);var aJ=setInterval(function(){if(Q.find(".tg-grid-loaded").length===2){aq(window).trigger(s);clearInterval(aJ)}},50);A();W()},error:function(aI,aJ){p.removeClass("loading-anim").html(aJ.message)}}});var A=function(){aq(".tomb-post-type-skin").on("change",function(){W();aq("#tg-grid-skins .tg-grid-wrapper:not(.skin-hidden) .tg-filter-active").click()});aq("#the_grid_post_type").on("change",function(){e(aq(this))});aq(".the_grid_style input").on("change",function(){av={};aq(".the_grid_social_skin").val("");aq("#tg-grid-"+C+"-skin").addClass("skin-hidden");C=(aq(this).val()==="justified")?"grid":aq(this).val();an=(C==="grid")?x:k;aq("#tg-grid-"+C+"-skin").removeClass("skin-hidden");W()});M.on("change",function(){W()})};aq(document).on("click","#tg-grid-skins .tg-item, #tg-grid-skins .tg-item *",function(aJ){var aI=aq(aJ.target).attr("class");if(aI&&(aI.indexOf("tg-edit-skin")>0||aI.indexOf("dashicons-admin-tools")>=0)){return}else{aJ.preventDefault();if(M.find('input[type="radio"]:checked').val()=="post_type"){aa();av[T]=aq(this).closest(".tg-item").find(".tg-item-skin-name").data("slug")}else{w=aq(this).closest(".tg-item").find(".tg-item-skin-name").data("slug");aq(".the_grid_social_skin").val(w)}W()}});var e=function(aM){var aO=aM,aL=null,aN=(aO.val())?aO.val():["post"];for(var aK=0;aK<aN.length;aK++){var aI=aN[aK];var aJ=aq('#the_grid_post_type [value="'+aI+'"]').text();aL+='<option value="'+aI+'">'+aJ+"</option>"}aq("select.tomb-post-type-skin option").remove();aq("select.tomb-post-type-skin").append(aL).trigger("change");av={};W()};var B=function(){aq("input.tomb-grid-skins").val(JSON.stringify(av))};var aa=function(){T=aq(".tomb-post-type-skin").val()};var W=function(){if(M.find('input[type="radio"]:checked').val()=="post_type"){aa();if(!Object.keys(av).length){aq("select.tomb-post-type-skin option").each(function(){w=av[aq(this).val()]=an})}else{w=av[T];if(!w){w=av[T]=an}}B()}else{w=aq(".the_grid_social_skin").val();w=(!w)?an:w}Q.find(".tg-item").removeClass("selected");Q.find('.tg-item-skin-name[data-slug="'+w+'"]').closest(".tg-item").addClass("selected")}}var aj=aq("#tg-grid-preview"),V=aq("#tg-grid-preview-inner"),ax=aq("#tg-grid-preview-loading"),ah=aq("#tg-grid-preview-viewport"),ab=aq("#tg-grid-preview-settings"),ap=aq(".tg-filter-tooltip"),H=aq(".tg-grid-preloader-styles"),ay=0,I,s=(typeof tg_global_var!=="undefined"&&tg_global_var.debounce)?"debouncedresize":"resize";aq(document).on("click","#tg_post_preview, #tg-grid-preview-refresh",function(){if(ak&&(ak.readyState==3||ak.readyState==2||ak.readyState==1)){return false}aq("body").css("overflow","hidden");ap.remove();aq.TG_media_destroy(V);ax.show();V.html("");at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_grid_preview",post_ID:aq("#post_ID").attr("value"),meta_data:TG_metaData(aq("#the_grid_metabox .tomb-row")),callbacks:{before:function(aI,aJ,aK){aj.addClass("tg-show-preview");ax.html(Y.tg_grid_preview.before)},success:function(aI,aJ,aK){if(aJ.content){ax.html("");V.append(aJ.content);y();z();TG_excludeItem();H.removeAttr("scoped");V.find(".tg-grid-holder").The_Grid();aq.TG_media_init()}else{V.html(aJ.content)}},error:function(aI,aJ){ax.html(aJ.message)}}})});function y(){I=V.find(".tg-grid-holder").data("cols");if(I){I.sort(function(aJ,aI){return aI[0]-aJ[0]});aq(".tg-grid-preview-mobile").data("val",I[5][0]);aq(".tg-grid-preview-tablet-small").data("val",I[4][0]);aq(".tg-grid-preview-tablet").data("val",I[3][0]);aq(".tg-grid-preview-desktop-small").data("val",I[2][0]);aq(".tg-grid-preview-desktop-medium").data("val",I[1][0]);aq(".tg-grid-preview-desktop-large").data("val","100%")}}function z(){var aM=aq(window).width(),aL,aI;var aJ=ah.find(".tg-viewport-active").data("val");aJ=(aJ=="100%")?aM:aJ;if(ay!==aM&&I){I[0][0]=ay=aM;aq.each(I,function(aO,aN){if(aN[0]>=aM){aI=6-1-aO;aL=aN[0]}else{return false}});if(aJ>=aM){aL=(aL>I[1][0]&&aL>ay)?ay:aL;ah.find("div").removeClass("tg-viewport-active");ah.children().eq(aI).show().addClass("tg-viewport-active");V.width(aL)}ah.find("div").show();aI=(!aI)?0:aI;if(aI+1<6){for(var aK=aI+1;aK<=6;aK++){ah.children().eq(aK).hide()}}}}aq(window).resize(function(){z()});ah.find("div").click(function(){if(V.find(".tg-grid-loaded").length>0){var aJ=aq(this),aI=aJ.data("val");ah.find("div").removeClass("tg-viewport-active");aJ.addClass("tg-viewport-active");V.width(aI);aq(window).trigger(s)}});aq(document).on("click","#tg-grid-preview-close",function(){aj.removeClass("tg-show-preview");aq("body").css("overflow","visible");setTimeout(function(){ab.removeClass("loaded");V.html("");ap.remove()},400)});aq(document).on("click",'[data-target="Skins"].tomb-tab',function(){setTimeout(function(){aq(window).trigger("resize")},100)});aq(document).on("click","#tg-grid-preview-inner .tg-item *",function(aI){aI.preventDefault()});window.TG_excludeItem=function(aJ,aI){var aK=aq("#the_grid_post_not_in").val(),aL=aK.split(", ");aq("#tg-grid-preview .tg-item-exclude").each(function(){var aN=aq(this),aM=aN.data("id").toString();if(aq.inArray(aM,aL)>-1){aN.prevAll(".tg-item-hidden-overlay").addClass("tg-item-hidden");aN.addClass("tg-item-excluded")}})};aq(document).on("click",".tg-item-exclude",function(){var aM=aq(this),aI=aM.data("id").toString(),aJ=aq("#the_grid_post_not_in").val(),aK=aJ.split(", ");if(aq.inArray(aI,aK)==-1){aM.prevAll(".tg-item-hidden-overlay").addClass("tg-item-hidden");aM.addClass("tg-item-excluded");var aL=(aJ==="")?"":", ";aq("#the_grid_post_not_in").val(aJ+aL+aI)}else{aM.prevAll(".tg-item-hidden-overlay").removeClass("tg-item-hidden");aM.removeClass("tg-item-excluded");aK=jQuery.grep(aK,function(aN){return aN!=aI});aK=aK.join(", ");aq("#the_grid_post_not_in").val(aK)}});var ae=aq("#tg-grid-preview-settings");aq(document).on("click",".tg-item-settings",function(){var aJ=aq(this);var aI=aJ.data("action");aq.ajax({type:"GET",url:aI,beforeSend:function(){aJ.addClass("loading");ae.removeClass("loaded")},success:function(aK){aJ.removeClass("loading");aK=aq(aK).find("#the_grid_item_formats").html();aq("#tg-grid-preview-settings-save").data("id",aJ.data("id"));ae.find(">*").not("#tg-grid-preview-settings-footer").remove();ae.prepend(aK);ae.find(".hndle").append('<div id="tg-grid-preview-settings-close" class="dashicons dashicons-no-alt"></div>');ae.draggable();ae.addClass("loaded");TOMB_JS.init()}})});aq(document).on("click","#tg-grid-preview-settings-close",function(){ae.removeClass("loaded")});aq(document).on("click","#tg-grid-preview-settings-save",function(){var aK=aq(this),aI,aJ=aK.closest("#tg-grid-preview-settings").find(".tomb-row");at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_save_item_settings",post_ID:aK.data("id"),meta_data:JSON.stringify(TG_metaData(aJ)),callbacks:{before:function(aL,aM,aN){ae.find(".tg-grid-preview-settings-wait").html(Y.tg_save_item_settings.before);ae.find(".spinner").show();ae.addClass("saving")},success:function(aL,aM,aN){clearTimeout(aI);ae.find(".spinner").hide();ae.find(".tg-grid-preview-settings-wait").html("")},error:function(aL,aM){ae.find(".spinner").hide();ae.find(".tg-grid-preview-settings-wait").html(Y.tg_save_item_settings.error);aI=setTimeout(function(){ae.removeClass("saving")},2500)}}})});aq(document).on("click",".tg-button-register",function(){aq(this).closest(".tg-container").addClass("tg-container-anim")});aq(document).on("click","#tg-grid-save-envato-api-token",function(){var aI=aq(this);at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_save_envato_api_token",token:aq('[name="the_grid_envato_api_token"]').val(),callbacks:{before:function(aJ,aK){aI.nextAll(".spinner").css("visibility","visible").show();aI.nextAll("strong").html(Y[aJ.func].before)},success:function(aJ,aK,aL){aI.nextAll(".spinner").css("visibility","hidden").hide();aI.nextAll("strong").html(Y[aJ.func].success);if(aq(".tg-custom-skins-overview").length){location.reload()}else{setTimeout(function(){aq(".tg-row").html(aq(aK.content).html())},1500)}},error:function(aJ,aK){aI.nextAll(".spinner").css("visibility","hidden").hide();aI.nextAll("strong").html(aK.message);setTimeout(function(){aq(".tg-row").html(aq(aK.content).html())},2000)}}})});aq(document).on("click","#tg-check-update",function(){var aI=aq(this);at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_check_for_update",callbacks:{before:function(aJ,aK){aI.nextAll(".spinner").css("visibility","visible").show();aI.nextAll("strong").html(Y[aJ.func].before)},success:function(aJ,aK,aL){aI.nextAll(".spinner").css("visibility","hidden").hide();aI.nextAll("strong").html(Y[aJ.func].success);setTimeout(function(){aI.nextAll("strong").html("");aq(".tg-row").html(aq(aK.content).html())},1500)},error:function(aJ,aK){aI.nextAll(".spinner").css("visibility","hidden").hide();aI.nextAll("strong").html(aK.message);setTimeout(function(){aI.nextAll("strong").html("")},2000)}}})});aq(document).on("click",".update-now.tg-button-live-update",function(aJ){var aI=aq(this);aI.nextAll(".spinner").css("visibility","visible").show();aI.nextAll("strong").html(Y.tg_update_plugin.before)});aq(document).on("click",".tg-skins-style-button",function(){var aJ=aq(this),aI=aJ.data("style");aq(".tg-skins-style-button").removeClass("tg-selected");aJ.addClass("tg-selected");aq(".tg-grid-wrapper").addClass("skin-hidden");aq("#tg-grid-"+aI+"-skin").removeClass("skin-hidden")});aq(document).on("click",".tg-custom-skins-overview .tg-item-inner, .tg-custom-skins-overview .tg-item-inner *",function(aI){aI.preventDefault()});aq(document).on("click","#tg-import-skin-demo",function(){at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_import_demo_skins",callbacks:{before:g,success:function(aI,aJ,aK){aq(o).html(aK);setTimeout(function(){aq(h).removeClass(al);if(aJ.content){var aL=aq(aJ.content);aq(".tg-custom-skins-overview").replaceWith(aL);aq(".tg-grid-holder").The_Grid()}},800)},error:F}})});function ag(){var aI={};aI.item={};aI.elements={};aq(".tg-skin-build-inner [data-item-area]").each(function(){var aJ=aq(this).data("item-area");aI.elements[aJ]={};if(aq(this).is(":visible")){aq(this).find("> .tg-element-draggable").each(function(){var aL=aq(this);aI.elements[aJ][aL.data("name")]=aL.data("settings");var aK=aq(this).clone();aK.find(".tg-element-helper, .ui-resizable-handle, .tg-element-icon").remove();aK=aK.html();aI.elements[aJ][aL.data("name")].content=aK})}});aq(".tg-panel-item > div > [data-settings]").each(function(){var aK=aq(this).data("prefix");var aJ=aq(this).data("settings");if(aq(this).data("style")&&aq.inArray(aJ,["animations","action","z-index"])===-1){if(!aI.item.containers){aI.item.containers={}}aI.item.containers[aJ]={};aq(this).find('[data-settings="styles"]').each(function(){var aM=aq(this).data("settings");aI.item.containers[aJ][aM]={};aq(this).find("[data-settings]").each(function(){aK=aq(this).data("prefix");aI.item.containers[aJ][aM][aq(this).data("settings")]=TG_field_value(aq(this),aK);if(aq(this).data("settings")==="idle_state"){var aO=aq('[name="'+aK+'z-index"]').val();aI.item.containers[aJ][aM][aq(this).data("settings")]["z-index"]=(aO)?aO:""}});aI.item.containers[aJ][aM].is_hover=aq(this).find('[name="is_hover"]').is(":checked");var aL=aq('.tg-panel-item [data-settings="animation"] [data-settings=\''+aJ+"']");aI.item.containers[aJ].animation=TG_field_value(aL,aL.data("prefix"));var aN=aq('.tg-panel-item [data-settings="action"] [data-settings=\''+aJ+"']");aI.item.containers[aJ].action=TG_field_value(aN,aN.data("prefix"))})}else{if(aq.inArray(aJ,["animations","action","z-index"])===-1){if(aJ!="global_css"){aI.item[aq(this).data("settings")]=TG_field_value(aq(this),aK)}else{aI.item[aq(this).data("settings")]=aq(this).find("textarea").val()}}}});aI.item.layout.skin_name=aq('[name="skin_name"]').val();return aI}aq(document).on("click","#tg_skin_save",function(){var aJ=aq(this);var aI=ag();at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aJ.data("action"),id:m("id"),settings:JSON.stringify(aI),callbacks:{before:g,success:function(aK,aM,aN){var aL=window.location.href,aO=aL.substr(aL.lastIndexOf("/")+1);aL=aL.replace(aO,"admin.php?page=the_grid_skin_builder&id="+aM.message);if(history.pushState){history.pushState(null,null,aL)}else{window.location.href=aL}aq(o).html(aN);setTimeout(function(){aq(h).removeClass(al)},800)},error:F}})});aq(document).on("click","#tg_download_skin",function(){var aI=ag();aq('[name="tg_export_skin"]').val(JSON.stringify(aI));aq('[name="tg_export_skin"]').trigger("click");aq(o).html(f.before+Y.tg_download_skin.before);aq(h).addClass(al);setTimeout(function(){aq(o).html(f.success+Y.tg_download_skin.success);setTimeout(function(){aq(h).removeClass(al)},800)},800)});aq(document).on("click",".tg-delete-skin, .tg-clone-skin",function(){var aK=aq(this),aJ=aq(".tg-skins-style-button.tg-selected").data("style"),aI=confirm(tg_admin_global_var.box_messages[aK.data("action")].message);if(!aI){return false}at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aK.data("action"),id:aK.data("id"),callbacks:{before:g,success:function(aL,aM,aN){aq(o).html(aN);setTimeout(function(){aq(h).removeClass(al);if(aM.content){var aO=aq(aM.content);aO.find(".tg-skins-style-button").removeClass("tg-selected");aq(".tg-custom-skins-overview").replaceWith(aO);aq(".tg-grid-holder").The_Grid();aq('.tg-skins-style-button[data-style="'+aJ+'"]').trigger("click")}},800)},error:F}})});window.TG_skin_elements={};var P=aq(".tg-elements-inner");if(P.length){var a=aq('<div class="tg-panel-elements-msg"></div>');aq.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:"tg_get_elements"},beforeSend:function(){a.html(Y.tg_get_elements.before);P.find(".tg-native-elements, .tg-custom-elements").html(a)},error:function(aI){a.html(Y.tg_get_elements.error);P.find(".tg-native-elements, .tg-custom-elements").html(a)},success:function(aJ){P.find(".tg-native-elements, .tg-custom-elements").html("");if(aJ.content){P.find(".tg-element-styles-holder").append(aJ.content.styles);P.find(".tg-native-elements").append(aJ.content.native_elements);P.find(".tg-custom-elements").append(aJ.content.custom_elements)}window.TG_skin_elements=(aJ.content.settings)?aJ.content.settings:{};if(typeof TG_skin_elements==="object"){for(var aI in TG_skin_elements){if(TG_skin_elements.hasOwnProperty(aI)){var aK=JSON.parse(TG_skin_elements[aI]);TG_element_color('[data-slug="'+aI+'"]',aK)}}}}})}var aF;var v="";aq(document).on("click","#tg-element-save",function(){var aL=aq(this);if(!v){aF=window.prompt(tg_admin_global_var.box_messages[aL.data("action")].message,"My element")}if(aF===null){return}var aJ=aq(".tg-element-draggable.tg-element-selected");var aI=aJ.data("settings");var aK=aJ.clone();aK.find(".tg-element-helper, .ui-resizable-handle, .tg-element-icon").remove();aK=aK.html();aI.content=aK;aI["color-scheme"]=(aJ.closest(".tg-light").length)?"tg-light":"tg-dark";at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aL.data("action"),overwrite:v,element_name:aF,element_settings:aI,callbacks:{before:g,success:function(aV,aR,aO){if(aR.content==="exists"){aq(h).removeClass(al);v=confirm(tg_admin_global_var.box_messages[aL.data("action")].message2);if(v){aq("#tg-element-save").trigger("click")}else{v=""}return false}var aX=aq(aR.content.markup);if(v){var aW=aq('.tg-element-custom[data-slug="'+aR.content.slug+'"]');if(aW.closest(".tomb-tab-content").hasClass(aX.find(".tomb-tab").data("target"))){aW.closest(".tg-element-holder").replaceWith(aX.find(".tg-element-holder"))}else{v=false;var aS=aW.closest(".tomb-tab-content");if(aS.find(".tg-element-holder").length===1){var aQ=aS.attr("class").split(/\s+/),aU=aq(".tg-custom-elements").find('[data-target="'+aQ[1]+'"]');aS.closest(".tg-move-tab").removeClass("tg-move-tab");aU.remove();aS.remove()}aW.closest(".tg-element-holder").remove()}}if(!v){var aN=aX.find(".tomb-tab").data("target"),aP=aq(".tg-elements-inner .tg-custom-elements").find("."+aN);if(aP.length){aP.prepend(aX.find(".tg-element-holder"))}else{var aM=aq(".tg-elements-inner .tg-custom-elements ul");if(!aM.length){aq(".tg-elements-inner .tg-custom-elements").append(aX)}else{aM.append(aX.find("li"));aX.find(".tomb-tab-content").insertAfter(aq(".tg-elements-inner .tg-custom-elements ul"));var aT=aM.children("li").get();aT.sort(function(aZ,aY){return aq(aZ).data("target").match(/\d+/)-aq(aY).data("target").match(/\d+/)});aq.each(aT,function(aY,aZ){aM.append(aZ)})}}}aq(".tg-element-styles-holder").append(aR.content.styles);TG_element_color('[data-slug="'+aR.content.slug+'"]',aI);TG_skin_elements[aR.content.slug]=JSON.stringify(aI);aq(".tg-no-custom-element").hide();v="";aq(o).html(aO);setTimeout(function(){aq(h).removeClass(al)},800)},error:F}})});aq(document).on("click",".tg-custom-element-delete",function(){var aJ=aq(this);var aI=confirm(tg_admin_global_var.box_messages[aJ.data("action")].message);if(!aI){return false}at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aJ.data("action"),id:aJ.data("id"),callbacks:{before:g,success:function(aL,aN,aQ){aq(o).html(aQ);var aK=aJ.closest(".tomb-tab-content");if(aK.find(".tg-element-holder").length===1){var aO=aK.attr("class").split(/\s+/),aP=aq(".tg-custom-elements").find('[data-target="'+aO[1]+'"]');aK.closest(".tg-move-tab").removeClass("tg-move-tab");aP.remove();aK.remove()}aJ.closest(".tg-element-holder").remove();aq('.tg-element-styles-holder .tg-element-styles[data-slug="'+aJ.prevAll("[data-slug]").data("slug")+'"]').remove();if(!aq(".tg-custom-elements .tg-element-holder").length){aq(".tg-no-custom-element").show()}var aM=aJ.prevAll("[data-slug]").data("slug");delete TG_skin_elements[aM];setTimeout(function(){aq(h).removeClass(al)},800)},error:F}})});aq(document).on("click","#tg_flickr_get_photosets_list",function(){var aI=aq(this);at({nonce:tg_admin_global_var.nonce,action:"backend_grid_ajax",func:aI.data("action"),user_url:aq('[name="the_grid_flickr_user_url"]').val(),callbacks:{before:g,success:function(aJ,aK,aL){aI.next("div").remove();aq(aK.content).insertAfter(aI);setTimeout(function(){aq(h).removeClass(al)},800)},error:F}})});aq(document).on("change",".tg_flickr_get_photosets_list select",function(){aq('[name="the_grid_flickr_photoset_id"]').val(aq(this).val())})})(jQuery);