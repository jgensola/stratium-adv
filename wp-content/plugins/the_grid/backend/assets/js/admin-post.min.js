(function(a){a(document).ready(function(){var M=a("[data-tg-taxonomy-terms]").data("tg-taxonomy-terms"),z=a(".the_grid_categories option"),H=a("#tg-filter-sort1"),b=[],X=[],C;if(M){a.each(M,function(aa,Z){X[aa]=[];b[aa]=[];a.each(Z.taxonomies,function(ab,ac){if(ac.hasOwnProperty("terms")){b[aa].push(S(ac.name,ac.name,ac.title,ac.count));X[aa].push(x(ac.name,ac.name,ac.title,ac.title,ac.count));a.each(ac.terms,function(ad,ae){b[aa].push(S(ae.id,ae.taxonomy,ae.title,ae.count));X[aa].push(x(ae.id,ae.taxonomy,ae.name,ae.title,ae.count))})}})})}function S(ac,Z,ab,aa){return'<option value="'+Z+":"+ac+'"'+(Z==ac?' disabled="disabled"':"")+">"+ab+"</option>"}function x(ad,Z,aa,ac,ab){return'<li class="tg-filter-item'+(Z==ad?" tg_is_taxonomy":"")+'" data-id="'+ad+'" data-name="'+escape(aa)+'" data-taxonomy="'+Z+'" data-number="'+ab+'"><span class="tg-filte-icon dashicons"></span>'+ac+'<span class="tg-remove-filter dashicons dashicons-no-alt"></div></li>'}a(".the_grid_categories_input.tomb-row").remove();a('[name="the_grid_filters_order_1"]').addClass("tg_sort_filter_list");a(".tg-add-filters").on("click",function(){l()});a(".tg-filter-holder-number > div").each(function(){l();a(this).find("input").each(function(){var Z=a(this).data("input");var aa=a(this).val();if(a('[name="'+Z+'"]').attr("type")==="checkbox"&&aa){a('[name="'+Z+'"]').prop("checked",!a('[name="'+Z+'"]').prop("checked"))}a('[name="'+Z+'"]').val(aa).trigger("change")});a(this).find("ul").trigger("change")});var O=(a("#tg-cat-val").data("meta"))?a("#tg-cat-val").data("meta").split(","):"",w=(a("#tg-filter-load").data("meta"))?a("#tg-filter-load").data("meta").split(","):"";if(b){var m=a(".the_grid_post_type select"),D=a(".the_grid_post_type select").val();D=(D)?D:[a(".the_grid_post_type select option:first").val()];H.find("li").remove();a(".the_grid_categories select").find("option").remove();a(".the_grid_filter_onload select").find("option").remove();m.on("change",function(){H.html("");a(".tg-filter-sort2").html("");a(".the_grid_categories select").html("");a(".the_grid_filter_onload select").html("");var Z=a(this).val();if(Z){d(Z);y();a(".the_grid_filters_holder").each(function(aa){Y(a(this),a(this).find(".tg_sort_filter_list").val())})}K();a(".the_grid_categories select").trigger("change");a(".the_grid_filter_onload select").trigger("change")});a(".the_grid_post_type select").val(D).trigger("change");a(".the_grid_categories select").val(O).trigger("change");a(".the_grid_filter_onload select").val(w).trigger("change")}a(document).on("click",".tg-delete-filters",function(){var ag=a("#tg-available-filters-holder").data("delete-msg");var ac=confirm(ag);if(!ac){return false}var af=a(this).closest(".the_grid_filters_holder");var ab=af.find("ul li").clone();var aa=af.find(".tg-filter-name-area").html();var Z=a(".tg-layout-filter").length;H.append(ab);af.add(a('[data-func="the_grid_get_filters_'+aa+'"]')).remove();if(aa<Z){for(var ad=aa;ad<=Z;ad++){var ae=ad-1;a('[data-func="the_grid_get_filters_'+ad+'"]').find(".tg-filter-func-nb").html(ae);a('[data-func="the_grid_get_filters_'+ad+'"]').data("func","the_grid_get_filters_"+ae);a('[data-func="the_grid_get_filters_'+ad+'"]').attr("data-func","the_grid_get_filters_"+ae)}}a(".the_grid_filters_holder").each(function(ah){A(ah+1)});o();TOMB_RequiredField.fetch()});function l(){var ad=a(".the_grid_filters_holder");var ac=ad.length;var Z=a(document).find(".the_grid_filters_holder").eq(ac-1);var aa=a(document).find(".the_grid_filters_holder").eq(0).clone();aa.find("h3").append(a('<div class="tg-delete-filters tg-button"><i class="dashicons dashicons-no-alt"></i></div>'));aa.find("ul li").remove();aa.find("input").val("");var ab=aa.insertAfter(Z);A(ac+1);TOMB_RequiredField.fetch();ab.find("select").each(function(){var ae=a(this);ae.val("");if(!ae.data("clear")){ae.find("option:first-child").prop("selected",true)}ae.trigger("change")});B(ac+1)}function B(Z){var aa=a("#tg-layout-wrapper").find('[data-func="the_grid_get_filters_'+Z+'"]');if(aa.length===0){a("#tg-layout-blocs-holder").append(a('<li class="tg-layout-bloc tg-layout-filter dashicons-admin-settings" data-func="the_grid_get_filters_'+Z+'">Filter - <span class="tg-filter-func-nb">'+Z+"</span></li>"))}else{aa.find(".tg-filter-func-nb").html(Z);aa.data("func","the_grid_get_filters_"+Z);aa.attr("data-func","the_grid_get_filters_"+Z)}n()}function A(Z){var aa=a(".the_grid_filters_holder").eq(Z-1);aa.find(".tg-filter-name-area").html(Z);aa.find("input, select").each(function(){var ab=a(this).attr("name");if(ab){a(this).closest(".tomb-row").removeClass(ab);if(a.isNumeric(ab.substr(ab.length-1))){ab=ab.slice(0,-2)}ab=ab+"_"+Z;a(this).attr("name",ab);a(this).closest(".tomb-row").addClass(ab);var ad=a("."+ab).data("tomb-required");if(ad){ad=ad.split(",");var ac=ad[0];ac=a.isNumeric(ac.substr(ac.length-1))?ac.slice(0,-2):ac;ac=ac+"_"+Z;a("."+ab).data("tomb-required",ac+","+ad[1]+","+ad[2]);a("."+ab).attr("data-tomb-required",ac+","+ad[1]+","+ad[2])}}});a('[name="the_grid_filters_number"]').val(a(".the_grid_filters_holder").length)}function n(){a(".tg-filter-sort2").sortable({axis:"y",scroll:true,containment:"parent",revert:150,tolerance:"intersect",forcePlaceholderSize:true,forceHelperSize:true,start:function(aa,Z){a(Z.helper).css({"max-width":a(Z.helper).closest("ul")[0]["clientWidth"]-10,left:5})},stop:function(aa,Z){a(Z.item).removeAttr("style")},update:function(aa,Z){K();a(this).closest(".the_grid_filters_holder").find(".tg_sort_filter_list").val("").trigger("change")},sort:function(aa,Z){a(Z.helper).css("max-width",a(Z.helper).closest("ul")[0]["clientWidth"]-10)},over:function(aa,Z){a(Z.helper).css("max-width",a(Z.helper).closest("ul")[0]["clientWidth"]-10)},out:function(aa,Z){a(Z.helper).css("max-width",H[0]["clientWidth"]-10)}}).disableSelection()}n();a(document).on("click",".tg-filter-button-add",function(){a(this).prevAll(".tg-filter-sort2").html(a("#tg-filter-sort1").html());K()});a(document).on("click",".tg-filter-button-remove",function(){a(this).prevAll(".tg-filter-sort2").html("");K()});a(document).on("change",".tg_sort_filter_list",function(){var Z=a(this).val();var aa=a(this).closest(".the_grid_filters_holder");Y(aa,Z);K()});a(document).on("click",".tg-remove-filter",function(){a(this).closest("li").remove();K()});function d(aa){var Z=[];var ab=[];a.each(aa,function(ad,ac){if(b[ac]&&X[ac]){a.merge(Z,b[ac]);a.merge(ab,X[ac])}});Z=jQuery.unique(Z);ab=jQuery.unique(ab);a(".the_grid_categories select, .the_grid_filter_onload select").html(Z);H.html(ab).find("li").draggable({connectToSortable:".connectedSortable",appendTo:"#tg-available-filters",zIndex:9,helper:"clone",revert:"invalid",revertDuration:0,start:function(ad,ac){a(ac.helper).css("max-width",H[0]["clientWidth"]-10)}}).disableSelection()}function y(){a(".the_grid_filters_holder").each(function(aa,ad){var ac=a.parseJSON(a(this).find("ul").closest(".tomb-row").find("input").val());if(ac){var ae=[];for(i=0;i<ac.length;i++){var Z=a('#tg-filter-sort1 li[data-id="'+ac[i].id+'"]').first();var ab=Z.clone();ae.push(ab)}a(this).find("ul").html(ae)}})}function K(){a(".the_grid_filters_holder").each(function(Z){var aa=a(this).find(".tg-filter-sort2");var ac=aa.closest(".tomb-row").find("input");var ab=[];aa.find("li").each(function(ad){ab[ad]={};ab[ad].id=a(this).data("id");ab[ad].taxonomy=a(this).data("taxonomy")});ac.val(JSON.stringify(ab))})}function Y(aa,Z){switch(Z){case"number_asc":aa.find("ul").append(aa.find("ul li").sort(T));aa.find("ul").append(aa.find("ul li").sort(q));break;case"number_desc":aa.find("ul").append(aa.find("ul li").sort(T));aa.find("ul").append(aa.find("ul li").sort(F));break;case"alphabetical_asc":aa.find("ul").append(aa.find("ul li").sort(T));break;case"alphabetical_desc":aa.find("ul").append(aa.find("ul li").sort(j));break}}function q(aa,Z){return(parseInt(a(Z).data("number"))<parseInt(a(aa).data("number")))?1:-1}function F(aa,Z){return(parseInt(a(Z).data("number"))<parseInt(a(aa).data("number")))?-1:1}function T(aa,Z){var ac=a(aa).data("name")?a(aa).data("name"):"",ab=a(Z).data("name")?a(Z).data("name"):"";return(ab.toString().toLowerCase().replace(/-/g,""))<(ac.toString().toLowerCase().replace(/-/g,""))?1:-1}function j(aa,Z){var ac=a(aa).data("name")?a(aa).data("name"):"",ab=a(Z).data("name")?a(Z).data("name"):"";return(ab.toString().toLowerCase().replace(/-/g,""))<(ac.toString().toLowerCase().replace(/-/g,""))?-1:1}var G="the_grid_metakey";var N="the_grid_metakey_compare";var k="the_grid_metakey_value";var r="the_grid_metakey_type";var V="the_grid_metakey_relation";var c=".the_grid_metakey-wrapper";var R=a("."+G+".tomb-row");var s=a("."+N+".tomb-row");var v=a("."+k+".tomb-row");var E=a("."+r+".tomb-row");var p=a("."+V+".tomb-row");var L=["IN","NOT IN","BETWEEN","NOT BETWEEN"];p.addClass("first the_grid_metakey-wrapper");p=a(".the_grid_metakey_relation");R.add(s).add(v).add(E).andSelf().wrapAll('<div class="the_grid_metakey-wrapper first"/>');R.find("input").attr("class",R.find("input").attr("name")).removeAttr("name");s.find("select").attr("class",s.find("select").attr("name")+" tomb-select").removeAttr("name").hide();v.find("input").attr("class",v.find("input").attr("name")).removeAttr("name");E.find("select").attr("class",E.find("select").attr("name")+" tomb-select").removeAttr("name").hide();p.find("select").attr("class",p.find("select").attr("name")+" tomb-select").removeAttr("name").hide();R=a("."+G);s=a("."+N);v=a("."+k);E=a("."+r);p=a("."+V);var g=false;var W=a('input[name="the_grid_meta_query"]').data("metakey");if(W&&W[1]){p.val(W[0].relation);R.val(W[1].key);s.val(W[1].compare).trigger("change");v.val(W[1].value);E.val(W[1].type).trigger("change");a(c).last().css("margin-left",70);for(i=2;i<W.length;i++){if(W[i].relation){P(".the_grid_metakey_relation",".the_grid_metakey-wrapper","");a(c).last().find("."+V).val(W[i].relation).trigger("change")}else{P(".the_grid_metakey-wrapper",".the_grid_metakey-wrapper",".the_grid_metakey_relation");a(c).last().find("."+G).val(W[i].key);a(c).last().find("."+N).val(W[i].compare).trigger("change");a(c).last().find("."+k).val(W[i].value);a(c).last().find("."+r).val(W[i].type).trigger("change")}h(a(c).last(),i)}}else{a(c).last().css("margin-left",70)}a(document).on("change keyup",".the_grid_metakey-wrapper input, .the_grid_metakey-wrapper select",function(){J()});a("#tg-add-relation").on("click",function(){P(".the_grid_metakey_relation",".the_grid_metakey-wrapper","");J()});a("#tg-add-metakey").on("click",function(){P(".the_grid_metakey-wrapper",".the_grid_metakey-wrapper",".the_grid_metakey_relation");J()});a(document).on("click",".tg-remove-metakey",function(){a(this).closest(c).remove();J()});a("#section_metakey_start .tomb-section-content").sortable({items:".the_grid_metakey-wrapper:not(.first)",placeholder:"the_grid_metakey-wrapper-highlight",stop:function(){J()}});function P(ac,ab,aa){var Z=a(ac+".first").not(aa).clone().addClass("cloned").removeClass("first").insertBefore(a(".the_grid_meta_query"));Z.append(a('<div class="tg-button tg-remove-metakey"><i class="dashicons dashicons-no-alt"></i></div>'));a(ac+".cloned").find("input").val("");a(ac+".cloned select").each(function(){var ad=a(this);if(ad.data("clear")){ad.val("").trigger("change")}else{ad.val("").find("option:first-child").prop("selected",true).trigger("change")}});a(ac+".cloned").removeClass("cloned")}function J(){var aa=0,Z=[],ab=[];g=false;a(".the_grid_metakey-wrapper").each(function(ae){var ag=a(this);if(ag.is("."+V)){ab[aa]={};ab[aa].relation=ag.find("select."+V).val();aa++}else{var ad=ag.find(".tomb-row ."+G).val();var ac=ag.find(".tomb-row ."+k).val();var af=ag.find(".tomb-row ."+N).val();if(ad&&ac){ab[aa]={};ab[aa].key=ad;if(a.inArray(af,L)>-1){ab[aa].value=ac.split(",")}else{ab[aa].value=ac}ab[aa].compare=af;ab[aa].type=ag.find(".tomb-row ."+r).val();aa++}}h(ag,ae)});if(ab.length>1){Z.push(ab);a('input[name="the_grid_meta_query"]').attr("value",JSON.stringify(Z[0]));a('input[name="the_grid_meta_query"]').data("metakey",Z[0])}else{a('input[name="the_grid_meta_query"]').attr("value","");a('input[name="the_grid_meta_query"]').data("metakey","")}}function h(aa,Z){if(aa.is("."+V)&&Z>1){g=true;aa.css("margin-left",70)}else{if(g===true&&!aa.is("."+V)){aa.css("margin-left",140)}else{if(Z>1){aa.css("margin-left",70)}}}}var e=a(".tg-data-amin").data("item-anim");a(".tg-data-amin").removeAttr("data-item-anim");a('select[name="the_grid_animation"], input[name="the_grid_transition"]').on("change",function(){f()});a("#tg-animation-preview-button").on("click",function(){f()});function f(){var aa=a('select[name="the_grid_animation"]').val();if(aa){var ac=e[aa].visible,Z=e[aa].hidden,ab=a('input[name="the_grid_transition"]').val();if(aa!=="none"){a("#tg-animation-preview").attr("data-animation",aa);a("#tg-animation-preview").css({opacity:0,transition:"none",transform:Z});setTimeout(function(){a("#tg-animation-preview").css("transform",Z).css({transition:"all "+ab+"ms ease",transform:ac,opacity:1})},150)}}}if(a("input#the_grid_name").length){var t=a("#tg-shortcode-wrong-name").text();a("input#the_grid_name").autoGrowInput({minWidth:220,comfortZone:10});a("input#the_grid_shortcode").css({width:340,"min-width":340});a("input#the_grid_name").on("keypress keydown keyup",function(){var Z=a(this).val();if(!Z){Z=t}else{Z='[the_grid name="'+Z+'"]'}a("input#the_grid_shortcode").val(Z);a("input#the_grid_shortcode").width(a("input#the_grid_name").width()+120)})}var U;a(".tg-layout-connected").sortable({connectWith:".tg-layout-connected",revert:"valid",zIndex:3,opacity:"0.9",appendTo:"body",receive:function(Z,aa){if((aa.item.hasClass("tg-layout-pagination")&&a("#tg-layout-blocs-entries .tg-layout-load-more").length)||(aa.item.hasClass("tg-layout-load-more")&&a("#tg-layout-blocs-entries .tg-layout-pagination").length)){aa.sender.sortable("cancel")}},update:function(Z,aa){if(this===aa.item.parent()[0]){o()}}}).disableSelection();a(".tg-layout-connected.tg-exclude").sortable({connectWith:".tg-layout-connected",receive:function(Z,aa){if(!aa.item.hasClass("tg-bloc-center")||!aa.item.hasClass("tg-bloc-center")){aa.sender.sortable("cancel")}}}).disableSelection();function o(){a(".tg-layout-area").each(function(){var aa=[];var ac=a(this);var ab=ac.find("li");var Z=ac.find("input");var ad=Z.data("value");ab.each(function(){if(a(this).css("display")==="inline-block"){aa.push(a(this).data("func"))}});ad.functions=aa;Z.val(JSON.stringify(ad)).data("value",ad);I(ac)})}function I(Z){if(Z.find("li").css("display")==="inline-block"){Z.find("span").fadeOut(300)}else{Z.find("span").fadeIn(300)}}a(".tg-layout-area input").each(function(){var ad=a(this);var aa=ad.closest(".tg-layout-area");var ac=ad.data("value");if(ac!==""){var ab=ac.functions;a.each(ab,function(ai,ah){var ag=a("#tg-layout-blocs-holder").find('[data-func="'+ah+'"]');var af=ag.clone();ag.remove();aa.find("ul").append(af)});var Z=ac.styles["text-align"];if(Z){aa.find(".tg-layout-connected").css("text-align",Z);aa.find('[data-val="'+Z+'"]').addClass("active")}else{aa.find('[data-val="left"]').addClass("active")}}else{var ae={};ae.styles={};ae.functions=[];ad.val(JSON.stringify(ae)).data("value",ae);aa.find('[data-val="left"]').addClass("active")}I(aa)});a(".tg-layout-setting-buttons div").on("click",function(){if(!a(this).is(".tg-layout-area-settings")){var ab=a(this).data("val");a(this).closest(".tg-layout-area").find(".tg-layout-setting-buttons div").removeClass("active");a(this).addClass("active");a(this).closest(".tg-layout-area").find("ul").css("text-align",ab);var aa=a(this).closest(".tg-layout-area").find("input").data("value");aa.styles["text-align"]=ab;var Z=a(this).closest(".tg-layout-area").find("input");Z.val(JSON.stringify(aa)).data("value",aa)}});a("#tg-layout-styles-box #tg-button-save-styles").on("click",function(){var Z=U;var aa=Z.data("value");a("#tg-layout-styles-box input[data-name]").each(function(){aa.styles[a(this).data("name")]=a(this).val()});Z.val(JSON.stringify(aa)).data("value",aa)});a("#tg-layout-styles-box").draggable();a("body, #tg-layout-styles-box .dashicons-no-alt, #tg-button-save-styles").on("click",function(){a("#tg-layout-styles-box").fadeOut(300)});a(".tg-layout-area-settings, #tg-layout-styles-box").on("click",function(Z){if(a(Z.target).is(".tg-layout-area-settings")){U=a(this).closest(".tg-layout-area").find("input");var aa=U.data("value");a("#tg-layout-styles-box input[data-name]").each(function(){var ab=aa.styles[a(this).data("name")];if(a(this).data("name")=="background"){if(ab){a("#tg-layout-styles-box .wp-color-result").css("background-color",ab+"!important")}else{a("#tg-layout-styles-box .wp-color-result").css("background-color","")}}else{ab=(ab)?ab:"0"}a(this).val(ab)})}if(!a(Z.target).is("#tg-layout-styles-box .dashicons-no-alt, #tg-button-save-styles")){Z.stopPropagation();a("#tg-layout-styles-box").fadeIn(300)}});a(".the_grid_layout input").on("change",function(){u();o()});a(".the_grid_source_type input").on("change",function(){u();o()});function u(){var Z=a(".the_grid_layout").find("input:checked").val();if(Z==="vertical"){a(".tg-layout-arrow-left, .tg-layout-arrow-right, .tg-layout-slider-bullets").addClass("hidden-block");a("#tg-layout-center-area .tg-layout-area, .tg-layout-arrow-left, .tg-layout-arrow-right, .tg-layout-slider-bullets").attr("style","display:none !important")}else{a(".tg-layout-arrow-left, .tg-layout-arrow-right, .tg-layout-slider-bullets").removeClass("hidden-block");a("#tg-layout-center-area .tg-layout-area, .tg-layout-arrow-left, .tg-layout-arrow-right, .tg-layout-slider-bullets").attr("style","")}Z=a(".the_grid_source_type input:checked").val();if(Z==="instagram"){a(".tg-layout-instagram-header").removeClass("hidden-block")}else{a(".tg-layout-instagram-header").addClass("hidden-block")}if(Z==="youtube"){a(".tg-layout-youtube-header").removeClass("hidden-block")}else{a(".tg-layout-youtube-header").addClass("hidden-block")}if(Z==="vimeo"){a(".tg-layout-vimeo-header").removeClass("hidden-block")}else{a(".tg-layout-vimeo-header").addClass("hidden-block")}}u();a(".the_grid_style input").on("change",function(){var Z=a(".the_grid_image_size");if(a(this).val()==="justified"){a('[name="the_grid_aqua_resizer"]').prop("checked","")}});a(".the_grid_preloader_style select").on("change",function(){var Z=a(this).val();a(".the_grid_preloader_preview").find(".tg-grid-preloader-inner").addClass("hide").removeClass("show");a(".the_grid_preloader_preview").find("."+Z).removeClass("hide").addClass("show")});a(".the_grid_preloader_color .tomb-colorpicker").wpColorPicker({change:function(aa,ab){var Z=ab.color.toString();a(".tg-grid-preloader-inner > div").css("background-color",Z);a(".tg-grid-preloader-inner.pacman > div,.tg-grid-preloader-inner.ball-clip-rotate > div").css("border-color",Z)}});a('input[name="the_grid_preloader_size"]').on("change",function(){a(".tg-grid-preloader-scale").css("transform","scale("+a(this).val()+")")});a(".preloader-styles").removeAttr("scoped");a(document).on("click",".the_grid_language span",function(){var Z=a(this);Z.closest(".tomb-field").find(".tomb-image-holder, input, img").removeAttr("data-checked checked");Z.attr("data-checked",1);Z.find("img").attr("data-checked",1);Z.find("input").attr("checked",1);var aa=Z.find("input").val();a("#tg_post_save").click();a(document).ajaxSuccess(function(){Q("lang",aa)})});function Q(ac,ad){var Z=window.location.href;if(Z.indexOf(ac+"=")>=0){var aa=Z.substring(0,Z.indexOf(ac));var ab=Z.substring(Z.indexOf(ac));ab=ab.substring(ab.indexOf("=")+1);ab=(ab.indexOf("&")>=0)?ab.substring(ab.indexOf("&")):"";Z=aa+ac+"="+ad+ab}else{if(Z.indexOf("?")<0){Z+="?"+ac+"="+ad}else{Z+="&"+ac+"="+ad}}window.location.href=Z}a("#wpbody").fadeIn(800)})})(jQuery);(function(a){a.fn.autoGrowInput=function(b){b=a.extend({maxWidth:1000,minWidth:0,comfortZone:70},b);this.filter("input:text").each(function(){var f=b.minWidth||a(this).width(),g="",d=a(this),e=a("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:d.css("fontSize"),fontFamily:d.css("fontFamily"),fontWeight:d.css("fontWeight"),letterSpacing:d.css("letterSpacing"),whiteSpace:"nowrap"}),c=function(){if(g===(g=d.val())){return}var m=g.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.html(m);var k=e.width(),l=(k+b.comfortZone)>=f?k+b.comfortZone:f,j=d.width(),h=(l<j&&l>=f)||(l>f&&l<b.maxWidth);if(h){d.width(l)}};e.insertAfter(d);a(this).on("keyup keydown blur update change",c)});return this}})(jQuery);